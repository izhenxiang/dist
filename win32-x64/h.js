var R=Object.defineProperty;var D=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var A=(e,o,a)=>o in e?R(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,B=(e,o)=>{for(var a in o||(o={}))q.call(o,a)&&A(e,a,o[a]);if(D)for(var a of D(o))Q.call(o,a)&&A(e,a,o[a]);return e};import{c as n}from"./t.js";import{i as b}from"./6.js";import{H as E,o as W,d as l,a as c,F as h,Q as y,m as H,e as s,t as g,p as k,i as I,_ as $,x as G,L as C,R as x,s as V,k as J,b as v,f as p,c as K,w as T,j as X,h as Y}from"./f.js";import{z as Z}from"./-.js";import{b as ee}from"./4.js";import{s as oe}from"./y.js";import"./5.js";import{H as L}from"./k.js";import"./c.js";import"./1.js";import"./0.js";import"./o.js";var f,N,m;({camera:f,main:N}=b);m=()=>{var e,o;if(gc(),document.hidden){localStorage.recing||f.x();return}switch(delete localStorage.recing,{src:e}=n,f.x(),e){case"screen":n.video="";break;default:if(!n.video){if({video:o}=localStorage,!o)return;n.video=o}e==="all"?f.circle(localStorage.人像尺寸-0):f.rect(),setTimeout(()=>{document.hidden||N(!1)},1e3)}};document.addEventListener("visibilitychange",m);var te={setup:()=>{var e,o,a,t,r,i;for(t=["all 屏幕+摄像头录制","screen 屏幕录制","camera 摄像头录制"],i=o=0,a=t.length;o<a;i=++o)e=t[i],r=e.indexOf(" "),t[i]=[e.slice(0,r),e.slice(1+r)];return E(()=>n.src,m),W(m),E(()=>n.video,d=>{var u;document.hidden||({src:u}=n,d?u==="screen"&&(n.src=localStorage.src||"all"):u!=="screen"&&(localStorage.src=n.src,n.src="screen"),m())}),{li:t,config:n,go:d=>{n.src=d}}}};const ae=e=>(k("data-v-1eb91dd6"),e=e(),I(),e),re={class:"method"},se=["onClick"],ne=ae(()=>s("b",{class:"ico"},null,-1));function ie(e,o){return l(),c("div",re,[(l(!0),c(h,null,y(e.li,([a,t])=>(l(),c("a",{class:H([a,e.config.src==a?"now":""]),onClick:r=>e.go(a)},[ne,s("i",null,g(t),1)],10,se))),256))])}var de=$(te,[["render",ie],["__scopeId","data-v-1eb91dd6"]]),le={setup:()=>({config:n,disabled:G(()=>n.src==="camera"),li:"整个桌面 应用窗口 指定区域".split(" ")})};const ce=e=>(k("data-v-cf47a3ec"),e=e(),I(),e),ue={class:"bk"},_e=ce(()=>s("h2",null,"录制区域",-1)),ve={class:"select"},pe=["disabled"],fe=["value"];function me(e,o){return l(),c("div",ue,[_e,s("div",ve,[C(s("select",{disabled:e.disabled,"onUpdate:modelValue":o[0]||(o[0]=a=>e.config.area=a)},[(l(!0),c(h,null,y(e.li,(a,t)=>(l(),c("option",{value:t},g(a),9,fe))),256))],8,pe),[[x,e.config.area]])])])}var he=$(le,[["render",me],["__scopeId","data-v-cf47a3ec"]]),ge={components:{zAudio:Z},setup:()=>{var e,o,a;return a={audio:V([]),video:V([])},{mediaDevices:e}=navigator,o=async()=>{var t,r,i,d,u,w,F,_,S,U,z;w={},F=await e.enumerateDevices();for(U of F)({kind:d,label:u,deviceId:t}=U),t==="default"&&(u=u.replace("Default - ","默认 ")),d.endsWith("input")&&(d=d.slice(0,-5),(w[d]=w[d]||[]).push([t,u]));for(i in a)a[i].value=w[i]||[];for(i in a){if({value:S}=a[i],S.length){if(_=n[i],_){for(z of S)if([r]=z,_===r)return}_!==""&&(_=S[0][0])}else _=0;n[i]=_}},J(()=>{var t,r,i,d,u;r=[["audio","microphone"],["video","camera"]];for(d of r)[t,u]=d,i=n[t],i&&(b.permission(u),localStorage[t]=i)}),(async()=>await o())(),B({refresh:o,config:n,x:t=>{var r;r=n[t],r?r="":r=localStorage[t]||"",n[t]=r}},a)}};const j=e=>(k("data-v-620b4a5a"),e=e(),I(),e),be={class:"bk"},$e=j(()=>s("h2",null,"设备设置",-1)),we={class:"video"},Se={class:"select"},ye={label:"输入源"},ke=["value"],Ie=j(()=>s("optgroup",{label:"───"},[s("option",{value:""},"禁用")],-1)),Ce={class:"audio"},xe={class:"select"},Ve={label:"输入源"},je=["value"],Fe=j(()=>s("optgroup",{label:"───"},[s("option",{value:""},"禁用")],-1));function Ue(e,o){const a=v("z-audio");return l(),c("div",be,[$e,s("li",we,[s("label",{class:H({x:!e.config.video}),onClick:o[0]||(o[0]=t=>e.x("video")),for:"driveVideo"},null,2),s("div",Se,[C(s("select",{id:"driveVideo",onFocus:o[1]||(o[1]=(...t)=>e.refresh&&e.refresh(...t)),"onUpdate:modelValue":o[2]||(o[2]=t=>e.config.video=t)},[s("optgroup",ye,[(l(!0),c(h,null,y(e.video,([t,r])=>(l(),c("option",{value:t},g(r),9,ke))),256))]),Ie],544),[[x,e.config.video]])])]),s("li",Ce,[s("label",{onClick:o[3]||(o[3]=t=>e.x("audio")),for:"driveAudio"},[p(a)]),s("div",xe,[C(s("select",{id:"driveAudio",onFocus:o[4]||(o[4]=(...t)=>e.refresh&&e.refresh(...t)),"onUpdate:modelValue":o[5]||(o[5]=t=>e.config.audio=t)},[s("optgroup",Ve,[(l(!0),c(h,null,y(e.audio,([t,r])=>(l(),c("option",{value:t},g(r),9,je))),256))]),Fe],544),[[x,e.config.audio]])])])])}var ze=$(ge,[["render",Ue],["__scopeId","data-v-620b4a5a"]]),De={components:{btn:ee}};const Ae=e=>(k("data-v-b0e482fa"),e=e(),I(),e),Be=Ae(()=>s("b",null,null,-1));function Ee(e,o){const a=v("btn");return l(),K(a,null,{default:T(()=>[Be,X(e.$slots,"default",{},void 0,!0)]),_:3})}var He=$(De,[["render",Ee],["__scopeId","data-v-b0e482fa"]]);var M,O;O=()=>{var e;return e=new Headers,e.append("user_token",localStorage.uid),e};M=class{constructor(o){this.json=this.json.bind(this),this.ipc=o}async fetch(o,a={}){var t;if(a.headers=O(),o.indexOf(".do")<0&&(o+=".do"),t=await fetch(L+o,a),t.status===401){delete localStorage.uid,this.ipc.auto_update.relaunch();return}return t}async json(o,a={}){var t;return t=await this.fetch(o,a),t.json()}};var Te=e=>new M(e);var Le=Te(b),Ne=new Proxy(()=>{},{get:(e,o)=>{_paq.push(["trackEvent","点",o])}}),P;({auto_update:P}=b);var Me={components:{src:de,rArea:he,drive:ze,btn:He},setup:()=>{var e,o;return o="开始录制",e=V(o),{txt:e,start:async()=>{var a,t,r;localStorage.recing=1,{avatarUrl:a,space:{used:r,max:t}}=await Le.json("user/get"),localStorage.ico=a,r>=t?(e.value="请付费扩容后点此录制",b.open(L+"?pay=true&user_token="+localStorage.uid)):(e.value=o,Ne.录,oe())}}}};(async()=>await P.update_promise())();function Oe(e,o){const a=v("src"),t=v("r-area"),r=v("drive"),i=v("btn");return l(),c(h,null,[p(a),s("main",null,[p(t),p(r),p(i,{onClick:e.start},{default:T(()=>[Y(g(e.txt),1)]),_:1},8,["onClick"])])],64)}var ao=$(Me,[["render",Oe],["__scopeId","data-v-4e6195cc"]]);export{ao as default};
