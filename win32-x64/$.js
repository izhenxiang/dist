import{H as p}from"./s.js";import{i}from"./1.js";import{c as o}from"./q.js";var c,d;d=async(r,a)=>{var e,t;return e=new Headers,e.append("user_token",localStorage.uid),r.startsWith("upload")&&(t=await a.auto_update.ua_now(),e.append("ua",t)),e};c=class{constructor(a){this.json=this.json.bind(this),this.ipc=a}async fetch(a,e={}){var t;if(e.headers=await d(a,this.ipc),a.indexOf(".do")<0&&(a+=".do"),t=await fetch(p+a,e),t.status===401){delete localStorage.uid,this.ipc.auto_update.relaunch();return}return t}async json(a,e={}){var t;return t=await this.fetch(a,e),t.json()}};var u=r=>new c(r);var n,w=u(i);n=1*60;var v=async function(){var r,a;try{({space:{max:a}}=await u(i).json("user/get"))}catch(e){r=e,console.error(r),a=500*1024*1024}a>=1e3*1024*1024*1024?(o.duration_txt="单次最长录制5小时",o.max_duration=5*60*60+n):a>=10*1024*1024*1024?(o.duration_txt='单次最长录制3小时, "扩容"可获更长时间',o.max_duration=3*60*60+n):(o.duration_txt='单次最长录制30分钟, "扩容"可获更长时间',o.max_duration=30*60+n)},g=async function(){var r,a,e;try{e=await u(i).json("notify/unread"),r=e[0]}catch(t){a=t,console.error(a),r=0}return r},h="https://matomo.dalukuankuan.com/",s;s=window._paq=window._paq||[];s.push(["setCustomDimension",1,await i.auto_update.ver_now()]);s.push(["trackPageView"]);s.push(["enableLinkTracking"]);localStorage.uid?s.push(["setUserId",localStorage.uid]):s.push(["resetUserId"]);(function(){var r,a,e,t;t=h,s.push(["setTrackerUrl",t+"matomo.php"]),s.push(["setSiteId","1"]),r=document,a=r.createElement("script"),e=r.getElementsByTagName("script")[0],a.async=!0,a.src=t+"matomo.js",e.parentNode.insertBefore(a,e)})();export{v as a,g as f,w as u};
