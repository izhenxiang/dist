"use strict";var en=Object.defineProperty;var Rt=Object.getOwnPropertySymbols;var tn=Object.prototype.hasOwnProperty,rn=Object.prototype.propertyIsEnumerable;var Ct=(t,e,r)=>e in t?en(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$t=(t,e)=>{for(var r in e||(e={}))tn.call(e,r)&&Ct(t,r,e[r]);if(Rt)for(var r of Rt(e))rn.call(e,r)&&Ct(t,r,e[r]);return t};var S=require("electron"),nn=require("os"),re=require("fs"),Z=require("path"),sn=require("crypto"),rr=require("zlib"),on=require("util"),oe=require("./w.js"),Se=require("fs/promises"),De=require("./x.js"),nr=require("./y.js"),an=require("events");function ir(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var Le=ir(nn),ln=ir(an),ze=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function sr(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}),e}var fn="win32",he=t=>{if(!!t&&!t.isDestroyed()){t.close();try{t.destroy()}catch{}}},un=(t,e)=>{var r,n;for(r in e)n=e[r],t.on(r,n);return t};dt=ut=ft=__dirname;var ft=ft,ut=ut,dt=dt,Ye,or;Ye="127.0.0.1",or="http://"+Ye,S.session.defaultSession.protocol.interceptStreamProtocol("http",(t,e)=>{var r,n,i,a,f,x,p,b,_;if(_=new URL(t.url),_.host===Ye)({pathname:f}=_),f==="/"&&(f+=".htm"),b=f.slice(f.lastIndexOf(".")+1),b.startsWith("htm")?a="text/html":a={js:"text/javascript",css:"text/css",svg:"image/svg+xml",woff2:"font/woff2"}[b]||"application/octet-stream",n=re.createReadStream(ut+f),e({data:n,statusCode:200,headers:{"content-type":a}});else{if(t.useSessionCookies=!0,t.partition="persist:I",x=S.net.request(t),x.on("response",v=>{var T,M;({headers:T,statusCode:M}=v),e({data:v},T,M)}),t.uploadData){p=t.uploadData;for(i of p)({bytes:r}=i),r&&x.write(r)}x.end()}});var me=new Proxy({},{get:(t,e)=>r=>{var n;return r=$t({skipTaskbar:!0,frame:!1,minimizable:!1,maximizable:!1,fullscreenable:!1,type:"toolbar",shadow:!1,hasShadow:!1,transparent:!0,webPreferences:{preload:Z.join(ft,"u.js"),webSecurity:!1}},r),n=new S.BrowserWindow(r),n.setMenu(null),e!=="main"&&n.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),n.loadURL(or+"#"+e),n.once("ready-to-show",()=>n.show()),n.focus(),n}}),dn="帧享",ar;({main:ar}=me);var ge=(t=!0)=>{var e,r,n;if(r=S.BrowserWindow.getAllWindows(),r.length){for(e of r)if(e.webContents.getURL().endsWith("/#main")){n=e,n.isMinimized()&&n.restore();break}}n||(n=ar({type:"",resizable:!1,height:590,width:426,skipTaskbar:!1}),n.setAppDetails({appId:dn,appIconPath:process.execPath})),!(!t&&!n.isVisible())&&(n.show(),n.moveTop(),n.focus())},lr={ID:""},cn="x64",rt;try{rt=new TextDecoder}catch{}var h,se,s=0,V={},W,ne,H=0,X=0,L,ee,N=[],k,Lt={useRecords:!1,mapsAsObjects:!0};class fr{}const ur=new fr;ur.name="MessagePack 0xC1";var ye=!1,dr=2;try{new Function("")}catch{dr=1/0}class _e{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,r){if(h)return gr(()=>(it(),this?this.unpack(e,r):_e.prototype.unpack.call(Lt,e,r)));se=r>-1?r:e.length,s=0,X=0,ne=null,L=null,h=e;try{k=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw h=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof _e){if(V=this,this.structures)return W=this.structures,Ue();(!W||W.length>0)&&(W=[])}else V=Lt,(!W||W.length>0)&&(W=[]);return Ue()}unpackMultiple(e,r){let n,i=0;try{ye=!0;let a=e.length,f=this?this.unpack(e,a):Fe.unpack(e,a);if(r){for(r(f);s<a;)if(i=s,r(Ue())===!1)return}else{for(n=[f];s<a;)i=s,n.push(Ue());return n}}catch(a){throw a.lastPosition=i,a.values=n,a}finally{ye=!1,it()}}_mergeStructures(e,r){e=e||[];for(let n=0,i=e.length;n<i;n++){let a=e[n];a&&(a.isShared=!0,n>=32&&(a.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in r||[])if(n>=0){let i=e[n],a=r[n];a&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=a)}return this.structures=e}decode(e,r){return this.unpack(e,r)}}function Ue(){try{if(!V.trusted&&!ye){let e=W.sharedLength||0;e<W.length&&(W.length=e)}let t=D();if(L&&(s=L.postBundlePosition),s==se)W.restoreStructures&&Ft(),W=null,h=null,ee&&(ee=null);else if(s>se){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!ye)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw W.restoreStructures&&Ft(),it(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function Ft(){for(let t in W.restoreStructures)W[t]=W.restoreStructures[t];W.restoreStructures=null}function D(){let t=h[s++];if(t<160)if(t<128){if(t<64)return t;{let e=W[t&63]||V.getStructures&&cr()[t&63];return e?(e.read||(e.read=ct(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,V.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[wr()]=D();return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(D(),D());return e}else{t-=144;let e=new Array(t);for(let r=0;r<t;r++)e[r]=D();return e}else if(t<192){let e=t-160;if(X>=s)return ne.slice(s-H,(s+=e)-H);if(X==0&&se<140){let r=e<16?ht(e):hr(e);if(r!=null)return r}return nt(e)}else{let e;switch(t){case 192:return null;case 193:return L?(e=D(),e>0?L[1].slice(L.position1,L.position1+=e):L[0].slice(L.position0,L.position0-=e)):ur;case 194:return!1;case 195:return!0;case 196:return Qe(h[s++]);case 197:return e=k.getUint16(s),s+=2,Qe(e);case 198:return e=k.getUint32(s),s+=4,Qe(e);case 199:return ue(h[s++]);case 200:return e=k.getUint16(s),s+=2,ue(e);case 201:return e=k.getUint32(s),s+=4,ue(e);case 202:if(e=k.getFloat32(s),V.useFloat32>2){let r=wt[(h[s]&127)<<1|h[s+1]>>7];return s+=4,(r*e+(e>0?.5:-.5)>>0)/r}return s+=4,e;case 203:return e=k.getFloat64(s),s+=8,e;case 204:return h[s++];case 205:return e=k.getUint16(s),s+=2,e;case 206:return e=k.getUint32(s),s+=4,e;case 207:return V.int64AsNumber?(e=k.getUint32(s)*4294967296,e+=k.getUint32(s+4)):e=k.getBigUint64(s),s+=8,e;case 208:return k.getInt8(s++);case 209:return e=k.getInt16(s),s+=2,e;case 210:return e=k.getInt32(s),s+=4,e;case 211:return V.int64AsNumber?(e=k.getInt32(s)*4294967296,e+=k.getUint32(s+4)):e=k.getBigInt64(s),s+=8,e;case 212:if(e=h[s++],e==114)return Zt(h[s++]&63);{let r=N[e];if(r)return r.read?(s++,r.read(D())):r.noBuffer?(s++,r()):r(h.subarray(s,++s));throw new Error("Unknown extension "+e)}case 213:return e=h[s],e==114?(s++,Zt(h[s++]&63,h[s++])):ue(2);case 214:return ue(4);case 215:return ue(8);case 216:return ue(16);case 217:return e=h[s++],X>=s?ne.slice(s-H,(s+=e)-H):wn(e);case 218:return e=k.getUint16(s),s+=2,X>=s?ne.slice(s-H,(s+=e)-H):xn(e);case 219:return e=k.getUint32(s),s+=4,X>=s?ne.slice(s-H,(s+=e)-H):pn(e);case 220:return e=k.getUint16(s),s+=2,Vt(e);case 221:return e=k.getUint32(s),s+=4,Vt(e);case 222:return e=k.getUint16(s),s+=2,Nt(e);case 223:return e=k.getUint32(s),s+=4,Nt(e);default:if(t>=224)return t-256;if(t===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+t)}}}const hn=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function ct(t,e){function r(){if(r.count++>dr){let i=t.read=new Function("r","return function(){return {"+t.map(a=>hn.test(a)?a+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}}")(D);return t.highByte===0&&(t.read=qt(e,t.read)),i()}let n={};for(let i=0,a=t.length;i<a;i++){let f=t[i];n[f]=D()}return n}return r.count=0,t.highByte===0?qt(e,r):r}const qt=(t,e)=>function(){let r=h[s++];if(r===0)return e();let n=t<32?-(t+(r<<5)):t+(r<<5),i=W[n]||cr()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=ct(i,t)),i.read()};function cr(){let t=gr(()=>(h=null,V.getStructures()));return W=V._mergeStructures(t,W)}var nt=Te,wn=Te,xn=Te,pn=Te;function Te(t){let e;if(t<16&&(e=ht(t)))return e;if(t>64&&rt)return rt.decode(h.subarray(s,s+=t));const r=s+t,n=[];for(e="";s<r;){const i=h[s++];if((i&128)===0)n.push(i);else if((i&224)===192){const a=h[s++]&63;n.push((i&31)<<6|a)}else if((i&240)===224){const a=h[s++]&63,f=h[s++]&63;n.push((i&31)<<12|a<<6|f)}else if((i&248)===240){const a=h[s++]&63,f=h[s++]&63,x=h[s++]&63;let p=(i&7)<<18|a<<12|f<<6|x;p>65535&&(p-=65536,n.push(p>>>10&1023|55296),p=56320|p&1023),n.push(p)}else n.push(i);n.length>=4096&&(e+=C.apply(String,n),n.length=0)}return n.length>0&&(e+=C.apply(String,n)),e}function Vt(t){let e=new Array(t);for(let r=0;r<t;r++)e[r]=D();return e}function Nt(t){if(V.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[wr()]=D();return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(D(),D());return e}}var C=String.fromCharCode;function hr(t){let e=s,r=new Array(t);for(let n=0;n<t;n++){const i=h[s++];if((i&128)>0){s=e;return}r[n]=i}return C.apply(String,r)}function ht(t){if(t<4)if(t<2){if(t===0)return"";{let e=h[s++];if((e&128)>1){s-=1;return}return C(e)}}else{let e=h[s++],r=h[s++];if((e&128)>0||(r&128)>0){s-=2;return}if(t<3)return C(e,r);let n=h[s++];if((n&128)>0){s-=3;return}return C(e,r,n)}else{let e=h[s++],r=h[s++],n=h[s++],i=h[s++];if((e&128)>0||(r&128)>0||(n&128)>0||(i&128)>0){s-=4;return}if(t<6){if(t===4)return C(e,r,n,i);{let a=h[s++];if((a&128)>0){s-=5;return}return C(e,r,n,i,a)}}else if(t<8){let a=h[s++],f=h[s++];if((a&128)>0||(f&128)>0){s-=6;return}if(t<7)return C(e,r,n,i,a,f);let x=h[s++];if((x&128)>0){s-=7;return}return C(e,r,n,i,a,f,x)}else{let a=h[s++],f=h[s++],x=h[s++],p=h[s++];if((a&128)>0||(f&128)>0||(x&128)>0||(p&128)>0){s-=8;return}if(t<10){if(t===8)return C(e,r,n,i,a,f,x,p);{let b=h[s++];if((b&128)>0){s-=9;return}return C(e,r,n,i,a,f,x,p,b)}}else if(t<12){let b=h[s++],_=h[s++];if((b&128)>0||(_&128)>0){s-=10;return}if(t<11)return C(e,r,n,i,a,f,x,p,b,_);let v=h[s++];if((v&128)>0){s-=11;return}return C(e,r,n,i,a,f,x,p,b,_,v)}else{let b=h[s++],_=h[s++],v=h[s++],T=h[s++];if((b&128)>0||(_&128)>0||(v&128)>0||(T&128)>0){s-=12;return}if(t<14){if(t===12)return C(e,r,n,i,a,f,x,p,b,_,v,T);{let M=h[s++];if((M&128)>0){s-=13;return}return C(e,r,n,i,a,f,x,p,b,_,v,T,M)}}else{let M=h[s++],E=h[s++];if((M&128)>0||(E&128)>0){s-=14;return}if(t<15)return C(e,r,n,i,a,f,x,p,b,_,v,T,M,E);let K=h[s++];if((K&128)>0){s-=15;return}return C(e,r,n,i,a,f,x,p,b,_,v,T,M,E,K)}}}}}function Jt(){let t=h[s++],e;if(t<192)e=t-160;else switch(t){case 217:e=h[s++];break;case 218:e=k.getUint16(s),s+=2;break;case 219:e=k.getUint32(s),s+=4;break;default:throw new Error("Expected string")}return Te(e)}function Qe(t){return V.copyBuffers?Uint8Array.prototype.slice.call(h,s,s+=t):h.subarray(s,s+=t)}function ue(t){let e=h[s++];if(N[e])return N[e](h.subarray(s,s+=t));throw new Error("Unknown extension type "+e)}var Ht=new Array(4096);function wr(){let t=h[s++];if(t>=160&&t<192){if(t=t-160,X>=s)return ne.slice(s-H,(s+=t)-H);if(!(X==0&&se<180))return nt(t)}else return s--,D();let e=(t<<5^(t>1?k.getUint16(s):t>0?h[s]:0))&4095,r=Ht[e],n=s,i=s+t-3,a,f=0;if(r&&r.bytes==t){for(;n<i;){if(a=k.getUint32(n),a!=r[f++]){n=1879048192;break}n+=4}for(i+=3;n<i;)if(a=h[n++],a!=r[f++]){n=1879048192;break}if(n===i)return s=n,r.string;i-=3,n=s}for(r=[],Ht[e]=r,r.bytes=t;n<i;)a=k.getUint32(n),r.push(a),n+=4;for(i+=3;n<i;)a=h[n++],r.push(a);let x=t<16?ht(t):hr(t);return x!=null?r.string=x:r.string=nt(t)}const Zt=(t,e)=>{var r=D();let n=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,r.highByte=e);let i=W[t];return i&&i.isShared&&((W.restoreStructures||(W.restoreStructures=[]))[t]=i),W[t]=r,r.read=ct(r,n),r.read()};var xr=typeof self=="object"?self:global;N[0]=()=>{};N[0].noBuffer=!0;N[101]=()=>{let t=D();return(xr[t[0]]||Error)(t[1])};N[105]=t=>{let e=k.getUint32(s-4);ee||(ee=new Map);let r=h[s],n;r>=144&&r<160||r==220||r==221?n=[]:n={};let i={target:n};ee.set(e,i);let a=D();return i.used?Object.assign(n,a):(i.target=a,a)};N[112]=t=>{let e=k.getUint32(s-4),r=ee.get(e);return r.used=!0,r.target};N[115]=()=>new Set(D());const pr=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");N[116]=t=>{let e=t[0],r=pr[e];if(!r)throw new Error("Could not find typed array for code "+e);return new xr[r](Uint8Array.prototype.slice.call(t,1).buffer)};N[120]=()=>{let t=D();return new RegExp(t[0],t[1])};const gn=[];N[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],r=s;return s+=e-t.length,L=gn,L=[Jt(),Jt()],L.position0=0,L.position1=0,L.postBundlePosition=s,s=r,D()};N[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function gr(t){let e=se,r=s,n=H,i=X,a=ne,f=ee,x=L,p=new Uint8Array(h.slice(0,se)),b=W,_=W.slice(0,W.length),v=V,T=ye,M=t();return se=e,s=r,H=n,X=i,ne=a,ee=f,L=x,h=p,ye=T,W=b,W.splice(0,W.length,..._),V=v,k=new DataView(h.buffer,h.byteOffset,h.byteLength),M}function it(){h=null,ee=null,W=null}const wt=new Array(147);for(let t=0;t<256;t++)wt[t]=+("1e"+Math.floor(45.15-t*.30103));var Fe=new _e({useRecords:!1});const yn=Fe.unpack;Fe.unpackMultiple;Fe.unpack;let mn=new Float32Array(1);new Uint8Array(mn.buffer,0,4);let Ie;try{Ie=new TextEncoder}catch{}let st,yr;const qe=typeof Buffer!="undefined",Ae=qe?Buffer.allocUnsafeSlow:Uint8Array,mr=qe?Buffer:Uint8Array,Kt=qe?4294967296:2144337920;let l,be,I,o=0,q,$=null;const vn=61440,bn=/[\u0080-\uFFFF]/,xe=Symbol("record-id");class Sn extends _e{constructor(e){super(e),this.offset=0;let r,n,i,a,f=0,x=mr.prototype.utf8Write?function(u,m,c){return l.utf8Write(u,m,c)}:Ie&&Ie.encodeInto?function(u,m){return Ie.encodeInto(u,l.subarray(m)).written}:!1,p=this;e||(e={});let b=e&&e.sequential,_=e.structures||e.saveStructures,v=e.maxSharedStructures;if(v==null&&(v=_?32:0),v>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(e.moreTypes=!0);let T=e.maxOwnStructures;T==null&&(T=_?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let M=v>32||T+v>64,E=v+64,K=v+T+64;if(K>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let J=[],ae=0,G=0;this.pack=this.encode=function(u,m){if(l||(l=new Ae(8192),I=new DataView(l.buffer,0,8192),o=0),q=l.length-10,q-o<2048?(l=new Ae(l.length),I=new DataView(l.buffer,0,l.length),q=l.length-10,o=0):o=o+7&2147483640,r=o,a=p.structuredClone?new Map:null,p.bundleStrings&&typeof u!="string"?($=[],$.size=1/0):$=null,i=p.structures,i){i.uninitialized&&(i=p._mergeStructures(p.getStructures()));let c=i.sharedLength||0;if(c>v)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let d=0;d<c;d++){let w=i[d];if(!w)continue;let B,O=i.transitions;for(let y=0,z=w.length;y<z;y++){let U=w[y];B=O[U],B||(B=O[U]=Object.create(null)),O=B}O[xe]=d+64}f=c}b||(i.nextId=c+64)}n&&(n=!1);try{if(A(u),$&&Yt(r,A),p.offset=o,a&&a.idsToInsert){o+=a.idsToInsert.length*6,o>q&&le(o),p.offset=o;let c=On(l.subarray(r,o),a.idsToInsert);return a=null,c}return m&kn?(l.start=r,l.end=o,l):l.subarray(r,o)}finally{if(i){G<10&&G++;let c=i.sharedLength||v;if(i.length>c&&(i.length=c),ae>1e4)i.transitions=null,G=0,ae=0,J.length>0&&(J=[]);else if(J.length>0&&!b){for(let d=0,w=J.length;d<w;d++)J[d][xe]=0;J=[]}if(n&&p.saveStructures){let d=l.subarray(r,o);return p.saveStructures(i,f)===!1?(p._mergeStructures(p.getStructures()),p.pack(u)):(f=c,d)}}m&Wn&&(o=r)}};const A=u=>{o>q&&(l=le(o));var m=typeof u,c;if(m==="string"){let d=u.length;if($&&d>=4&&d<4096){if(($.size+=d)>vn){let y,z=($[0]?$[0].length*3+$[1].length:0)+10;o+z>q&&(l=le(o+z)),$.position?(l[o]=200,o+=3,l[o++]=98,y=o-r,o+=4,Yt(r,A),I.setUint16(y+r-3,o-r-y)):(l[o++]=214,l[o++]=98,y=o-r,o+=4),$=["",""],$.size=0,$.position=y}let O=bn.test(u);$[O?0:1]+=u,l[o++]=193,A(O?-d:d);return}let w;d<32?w=1:d<256?w=2:d<65536?w=3:w=5;let B=d*3;if(o+B>q&&(l=le(o+B)),d<64||!x){let O,y,z,U=o+w;for(O=0;O<d;O++)y=u.charCodeAt(O),y<128?l[U++]=y:y<2048?(l[U++]=y>>6|192,l[U++]=y&63|128):(y&64512)===55296&&((z=u.charCodeAt(O+1))&64512)===56320?(y=65536+((y&1023)<<10)+(z&1023),O++,l[U++]=y>>18|240,l[U++]=y>>12&63|128,l[U++]=y>>6&63|128,l[U++]=y&63|128):(l[U++]=y>>12|224,l[U++]=y>>6&63|128,l[U++]=y&63|128);c=U-o-w}else c=x(u,o+w,B);c<32?l[o++]=160|c:c<256?(w<2&&l.copyWithin(o+2,o+1,o+1+c),l[o++]=217,l[o++]=c):c<65536?(w<3&&l.copyWithin(o+3,o+2,o+2+c),l[o++]=218,l[o++]=c>>8,l[o++]=c&255):(w<5&&l.copyWithin(o+5,o+3,o+3+c),l[o++]=219,I.setUint32(o,c),o+=4),o+=c}else if(m==="number")if(u>>>0===u)u<64?l[o++]=u:u<256?(l[o++]=204,l[o++]=u):u<65536?(l[o++]=205,l[o++]=u>>8,l[o++]=u&255):(l[o++]=206,I.setUint32(o,u),o+=4);else if(u>>0===u)u>=-32?l[o++]=256+u:u>=-128?(l[o++]=208,l[o++]=u+256):u>=-32768?(l[o++]=209,I.setInt16(o,u),o+=2):(l[o++]=210,I.setInt32(o,u),o+=4);else{let d;if((d=this.useFloat32)>0&&u<4294967296&&u>=-2147483648){l[o++]=202,I.setFloat32(o,u);let w;if(d<4||(w=u*wt[(l[o]&127)<<1|l[o+1]>>7])>>0===w){o+=4;return}else o--}l[o++]=203,I.setFloat64(o,u),o+=8}else if(m==="object")if(!u)l[o++]=192;else{if(a){let w=a.get(u);if(w){if(!w.id){let B=a.idsToInsert||(a.idsToInsert=[]);w.id=B.push(w)}l[o++]=214,l[o++]=112,I.setUint32(o,w.id),o+=4;return}else a.set(u,{offset:o-r})}let d=u.constructor;if(d===Object)Dt(u,!0);else if(d===Array){c=u.length,c<16?l[o++]=144|c:c<65536?(l[o++]=220,l[o++]=c>>8,l[o++]=c&255):(l[o++]=221,I.setUint32(o,c),o+=4);for(let w=0;w<c;w++)A(u[w])}else if(d===Map){c=u.size,c<16?l[o++]=128|c:c<65536?(l[o++]=222,l[o++]=c>>8,l[o++]=c&255):(l[o++]=223,I.setUint32(o,c),o+=4);for(let[w,B]of u)A(w),A(B)}else{for(let w=0,B=st.length;w<B;w++){let O=yr[w];if(u instanceof O){let y=st[w];if(y.write){y.type&&(l[o++]=212,l[o++]=y.type,l[o++]=0),A(y.write.call(this,u));return}let z=l,U=I,Q=o;l=null;let fe;try{fe=y.pack.call(this,u,ve=>(l=z,z=null,o+=ve,o>q&&le(o),{target:l,targetView:I,position:o-ve}),A)}finally{z&&(l=z,I=U,o=Q,q=l.length-10)}fe&&(fe.length+o>q&&le(fe.length+o),o=_n(fe,l,o,y.type));return}}Dt(u,!u.hasOwnProperty)}}else if(m==="boolean")l[o++]=u?195:194;else if(m==="bigint"){if(u<BigInt(1)<<BigInt(63)&&u>=-(BigInt(1)<<BigInt(63)))l[o++]=211,I.setBigInt64(o,u);else if(u<BigInt(1)<<BigInt(64)&&u>0)l[o++]=207,I.setBigUint64(o,u);else if(this.largeBigIntToFloat)l[o++]=203,I.setFloat64(o,Number(u));else throw new RangeError(u+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");o+=8}else if(m==="undefined")this.encodeUndefinedAsNil?l[o++]=192:(l[o++]=212,l[o++]=0,l[o++]=0);else if(m==="function")A(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+m)},Dt=this.useRecords===!1?this.variableMapSize?u=>{let m=Object.keys(u),c=m.length;c<16?l[o++]=128|c:c<65536?(l[o++]=222,l[o++]=c>>8,l[o++]=c&255):(l[o++]=223,I.setUint32(o,c),o+=4);let d;for(let w=0;w<c;w++)A(d=m[w]),A(u[d])}:(u,m)=>{l[o++]=222;let c=o-r;o+=2;let d=0;for(let w in u)(m||u.hasOwnProperty(w))&&(A(w),A(u[w]),d++);l[c+++r]=d>>8,l[c+r]=d&255}:e.progressiveRecords&&!M?(u,m)=>{let c,d=i.transitions||(i.transitions=Object.create(null)),w=o++-r,B;for(let O in u)if(m||u.hasOwnProperty(O)){if(c=d[O],c)d=c;else{let y=Object.keys(u),z=d;d=i.transitions;let U=0;for(let Q=0,fe=y.length;Q<fe;Q++){let ve=y[Q];c=d[ve],c||(c=d[ve]=Object.create(null),U++),d=c}w+r+1==o?(o--,Xe(d,y,U)):zt(d,y,w,U),B=!0,d=z[O]}A(u[O])}if(!B){let O=d[xe];O?l[w+r]=O:zt(d,Object.keys(u),w,0)}}:(u,m)=>{let c,d=i.transitions||(i.transitions=Object.create(null)),w=0;for(let O in u)(m||u.hasOwnProperty(O))&&(c=d[O],c||(c=d[O]=Object.create(null),w++),d=c);let B=d[xe];B?B>=96&&M?(l[o++]=((B-=96)&31)+96,l[o++]=B>>5):l[o++]=B:Xe(d,d.__keys__||Object.keys(u),w);for(let O in u)(m||u.hasOwnProperty(O))&&A(u[O])},le=u=>{let m;if(u>16777216){if(u-r>Kt)throw new Error("Packed buffer would be larger than maximum buffer size");m=Math.min(Kt,Math.round(Math.max((u-r)*(u>67108864?1.25:2),4194304)/4096)*4096)}else m=(Math.max(u-r<<2,l.length-1)>>12)+1<<12;let c=new Ae(m);return I=new DataView(c.buffer,0,m),l.copy?l.copy(c,0,r,u):c.set(l.slice(r,u)),o-=r,r=0,q=c.length-10,l=c},Xe=(u,m,c)=>{let d=i.nextId;d||(d=64),d<E&&this.shouldShareStructure&&!this.shouldShareStructure(m)?(d=i.nextOwnId,d<K||(d=E),i.nextOwnId=d+1):(d>=K&&(d=E),i.nextId=d+1);let w=m.highByte=d>=96&&M?d-96>>5:-1;u[xe]=d,u.__keys__=m,i[d-64]=m,d<E?(m.isShared=!0,i.sharedLength=d-63,n=!0,w>=0?(l[o++]=(d&31)+96,l[o++]=w):l[o++]=d):(w>=0?(l[o++]=213,l[o++]=114,l[o++]=(d&31)+96,l[o++]=w):(l[o++]=212,l[o++]=114,l[o++]=d),c&&(ae+=G*c),J.length>=T&&(J.shift()[xe]=0),J.push(u),A(m))},zt=(u,m,c,d)=>{let w=l,B=o,O=q,y=r;l=be,o=0,r=0,l||(be=l=new Ae(8192)),q=l.length-10,Xe(u,m,d),be=l;let z=o;if(l=w,o=B,q=O,r=y,z>1){let U=o+z-1;U>q&&le(U);let Q=c+r;l.copyWithin(Q+z,Q+1,o),l.set(be.slice(0,z),Q),o=U}else l[c+r]=be[0]}}useBuffer(e){l=e,I=new DataView(l.buffer,l.byteOffset,l.byteLength),o=0}clearSharedData(){this.structures&&(this.structures=[])}}yr=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,fr];st=[{pack(t,e,r){let n=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:i,targetView:a,position:f}=e(6);i[f++]=214,i[f++]=255,a.setUint32(f,n)}else if(n>0&&n<17179869184){let{target:i,targetView:a,position:f}=e(10);i[f++]=215,i[f++]=255,a.setUint32(f,t.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),a.setUint32(f+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),r(this.onInvalidDate());let{target:i,targetView:a,position:f}=e(3);i[f++]=212,i[f++]=255,i[f++]=255}else{let{target:i,targetView:a,position:f}=e(15);i[f++]=199,i[f++]=12,i[f++]=255,a.setUint32(f,t.getMilliseconds()*1e6),a.setBigInt64(f+4,BigInt(Math.floor(n)))}}},{pack(t,e,r){let n=Array.from(t),{target:i,position:a}=e(this.moreTypes?3:0);this.moreTypes&&(i[a++]=212,i[a++]=115,i[a++]=0),r(n)}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),r([t.name,t.message])}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),r([t.source,t.flags])}},{pack(t,e){this.moreTypes?Gt(t,16,e):Xt(qe?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let r=t.constructor;r!==mr&&this.moreTypes?Gt(t,pr.indexOf(r.name),e):Xt(t,e)}},{pack(t,e){let{target:r,position:n}=e(1);r[n]=193}}];function Gt(t,e,r,n){let i=t.byteLength;if(i+1<256){var{target:a,position:f}=r(4+i);a[f++]=199,a[f++]=i+1}else if(i+1<65536){var{target:a,position:f}=r(5+i);a[f++]=200,a[f++]=i+1>>8,a[f++]=i+1&255}else{var{target:a,position:f,targetView:x}=r(7+i);a[f++]=201,x.setUint32(f,i+1),f+=4}a[f++]=116,a[f++]=e,a.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),f)}function Xt(t,e){let r=t.byteLength;var n,i;if(r<256){var{target:n,position:i}=e(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=e(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=r&255}else{var{target:n,position:i,targetView:a}=e(r+5);n[i++]=198,a.setUint32(i,r),i+=4}n.set(t,i)}function _n(t,e,r,n){let i=t.length;switch(i){case 1:e[r++]=212;break;case 2:e[r++]=213;break;case 4:e[r++]=214;break;case 8:e[r++]=215;break;case 16:e[r++]=216;break;default:i<256?(e[r++]=199,e[r++]=i):i<65536?(e[r++]=200,e[r++]=i>>8,e[r++]=i&255):(e[r++]=201,e[r++]=i>>24,e[r++]=i>>16&255,e[r++]=i>>8&255,e[r++]=i&255)}return e[r++]=n,e.set(t,r),r+=i,r}function On(t,e){let r,n=e.length*6,i=t.length-n;for(e.sort((a,f)=>a.offset>f.offset?1:-1);r=e.pop();){let a=r.offset,f=r.id;t.copyWithin(a+n,a,i),n-=6;let x=a+n;t[x++]=214,t[x++]=105,t[x++]=f>>24,t[x++]=f>>16&255,t[x++]=f>>8&255,t[x++]=f&255,i=a}return t}function Yt(t,e){I.setUint32($.position+t,o-$.position-t);let r=$;$=null,e(r[0]),e(r[1])}let vr=new Sn({useRecords:!1});vr.pack;vr.pack;const kn=512,Wn=1024;var Mn="https://izx.dalukuankuan.com/",br="https://i-desk-ver.izhenxiang.com/",Sr,Tn=async t=>{var e,r;return t=await t,r=[],e=r.push.bind(r),t.on("data",e),new Promise((n,i)=>(t.on("end",()=>{n(Buffer.concat(r))}),t.on("error",i)))},Bn=t=>Tn(_r(t));Sr=t=>{var e;return e=S.net.request(t),e.end(),new Promise((r,n)=>(e.on("error",i=>{n(i)}),e.on("response",i=>{if(i.statusCode!==200){n(i);return}r(i)})))};var _r=t=>Sr(t),Be={};Be.version="1.0.0";Be.encode=function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};Be.decode=function(e){return e+=Array(5-e.length%4).join("="),e=e.replace(/\-/g,"+").replace(/\_/g,"/"),new Buffer(e,"base64")};Be.validate=function(e){return/^[A-Za-z0-9\-_]+$/.test(e)};var et=Be;var pe,Or,Ee,Ve,xt,Oe,pt,kr,Wr,gt,Re,Mr,yt,mt,Ce,ot,Ne;Wr=on.promisify(rr.brotliDecompress);var Un=()=>(S.app.relaunch(),S.app.exit());pe=Z.join(nr.ROOT,"v");re.mkdirSync(pe,{recursive:!0});Or="sha512";Ce=void 0;var Tr=()=>{he(Ce),Ce=void 0},Br=()=>{Tr(),Ce=me.update({width:400,height:500,resizable:!1})};Re=t=>Bn(br+t);Mr=t=>{var e;return e=sn.createHash(Or),new Promise(r=>re.createReadStream(t).on("data",e.update.bind(e)).on("end",()=>{r(e.digest().slice(0,8))}))};ot=(()=>{var t;return{v:t}=De.default,t&&oe.decode(t)})();var Ur=()=>oe.PACKAGE_JSON().version;pt=fn+"/"+cn+"/";Ne=oe.ver_int(Ur());Oe=0;mt=async()=>{var t,e;t=oe.encode(parseInt(new Date/1e3)),e=pt+"v?"+t;try{Oe=await Re(e)}catch{console.error("❌",e)}return Oe};kr=async t=>{var e,r,n,i,a,f,x,p,b,_,v,T,M,E,K,J,ae,G;if(t||(t=Oe||await mt()),!!t&&(G=t.readUintBE(0,6),!(Ne>=G))){if(n=oe.encode(G),e=Z.join(pe,n),re.existsSync(Z.join(e,oe.package_json))&&G===ot)return e;for(J=et.encode(await Re(pt+et.encode(t))),[r,i,x]=yn(await Wr(await Re(J))),T=A=>Se.mkdir(Z.join(e,A),{recursive:!0}),await Promise.all(r.map(T)),E=Z.dirname(__dirname),M=b=0,_=i.length;b<_;M=++b)if(p=i[M],a=Z.join(e,p),f=x[M],K=async A=>Buffer.compare(f,await Mr(A))===0,!(re.existsSync(a)&&await K(a))){if(await T(Z.dirname(p)),v=Z.join(E,p),re.existsSync(v)&&await K(v)){await Se.copyFile(v,a);continue}if(ae=re.createWriteStream(a),(await _r(br+et.encode(f))).pipe(rr.createBrotliDecompress()).pipe(ae),await new Promise(A=>{ae.on("finish",A)}),!await K(a))return}return De.default.v=n,ot=G,e}};var Ar=async()=>{var t,e;return t=await mt(),t&&(e=Ne<t.readUintBE(0,6),e)?t:0};gt=async()=>{var t;(t=await Ar())&&await Pr(t)};setInterval(gt,864e5);Ee=Ve=xt=void 0;yt=()=>Ve=new Promise(t=>xt=t);yt();var An=()=>Ve,Pr=(...t)=>(Ee||(Ee=kr(...t).then(async e=>{e&&(xt([Oe,JSON.parse(await Se.readFile(Z.join(e,oe.package_json),"utf8")).description]),yt())}).finally(()=>{Ee=!1})),Ve);setTimeout(async()=>{var t,e,r,n;if(re.existsSync(pe)){n=await Se.readdir(pe,{withFileTypes:!0});for(e of n)e.isDirectory()&&({name:r}=e,oe.decode(r)<Ne&&await Se.rm(Z.join(pe,r),{recursive:!0,force:!0}))}if(t=parseInt(new Date/864e5),t!==De.default.update_check)return De.default.update_check=t,await gt()},15e3);var Pn=Object.freeze(Object.defineProperty({__proto__:null,relaunch:Un,x:Tr,show:Br,ver_now:Ur,update_check:Ar,update_promise:An,update:Pr},Symbol.toStringTag,{value:"Module"}));var Je,vt,Ir,Er,bt,In,St,jr,Dr,ke;Le.default.platform();({Menu:vt,Tray:Ir,app:Er,globalShortcut:In}=require("electron"));ke=new Ir(Z.join(dt,"trayTemplate.png"));St=[{label:"媒体库",click:()=>{S.shell.openExternal(Mn+"video_library.html?user_token="+lr.ID)}},{label:"检测更新",click:Br},{type:"separator"}];Je=jr=vt.buildFromTemplate([{label:"显示界面",click:ge},...St,{label:"退出",click:()=>Er.quit()}]);Dr=vt.buildFromTemplate(St);bt=["click",()=>{ge()}];ke.on("right-click",t=>{ke.popUpContextMenu(Je)});var En=()=>{ke.off(...bt),Je=Dr},zr=()=>{ke.on(...bt),Je=jr};var Rr;Rr=t=>{var e,r,n,i,a,f,x,p;t&&(t.devToolsWebContents||({webContents:a}=t,e=new S.BrowserWindow({minimizable:!1,maximizable:!1}),[i,r]=t.getSize(),[x,p]=t.getPosition(),{width:f,height:n}=S.screen.getPrimaryDisplay().workArea,a.setDevToolsWebContents(e.webContents),a.openDevTools({mode:"detach"}),i>r?(p=0,i=0,r+=20,n-=r):(x=0,r=0,f-=i),e.setPosition(i,r),t.setPosition(x,p),e.setSize(f,n),t.focus()))};var jn=()=>{S.globalShortcut.register("CmdOrCtrl+Alt+I",()=>Rr(S.BrowserWindow.getFocusedWindow()))},He=t=>{S.BrowserWindow.getAllWindows().forEach(e=>{var r,n;if(n=e.webContents.getURL(),n){if({hash:r}=new URL(n),r=r.slice(1),r.startsWith("main")){t?(e[t](),t==="show"&&e.once("show",()=>{e.setAlwaysOnTop(!0,"screen-saver"),setTimeout(()=>e.setAlwaysOnTop(!1,"screen-saver"),1e3)})):e.hide();return}if(r.startsWith("camera"))return}he(e)})},Dn=()=>{S.BrowserWindow.getAllWindows().forEach(t=>{var e,r;if(r=t.webContents.getURL(),r&&({hash:e}=new URL(r),e=e.slice(1),e.startsWith("main"))){t.hide();return}he(t)})},Cr,Ze,$r,de,P,_t;({camera:$r}=me);P=void 0;de=void 0;Cr=204;var Lr=()=>{P&&!P.isDestroyed()&&P.getSize()[0]!==800&&(de=P.getPosition()),he(P)},zn=t=>{var e,r;r=P.getSize()[0],r!==t&&(de=P.getPosition(),e=Math.round((t-r)/2),P.setBounds({x:de[0]-e,y:de[1]-e,width:t,height:t}))};Ze=!1;var Fr=()=>_t(800,500),Rn=_t=(t,e)=>{P&&!P.isDestroyed()||(P=$r({width:t,height:e,center:!0,roundedCorners:!1,resizable:!1,transparent:!0}),Ze&&Ot())},Cn=t=>{var e,r,n,i,a;P&&!P.isDestroyed()||(t=t||Cr,_t(t,t),de?[e,r]=de:({width:a,height:n}=S.screen.getPrimaryDisplay().size,i=62,e=i,r=n-i-t),P.setPosition(e,r))},$n=()=>{Lr(),Fr()},Ot=()=>{P&&!P.isDestroyed()&&(P.setAlwaysOnTop(!0,"pop-up-menu"),P.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0})),Ze=!0},qr=()=>{P&&!P.isDestroyed()&&(P.setAlwaysOnTop(!1),P.setVisibleOnAllWorkspaces(!1)),Ze=!1},Ln=Object.freeze(Object.defineProperty({__proto__:null,x:Lr,size:zn,rect:Fr,default:Rn,circle:Cn,x_rect:$n,top:Ot,untop:qr},Symbol.toStringTag,{value:"Module"})),kt=new Proxy({},{get:(t,e)=>()=>{var r,n,i;return{width:n,height:r}=S.screen.getPrimaryDisplay().size,i=me[e]({width:n,height:r,roundedCorners:!1,transparent:!0,resizable:!1,hasShadow:!1}),i.setAlwaysOnTop(!0,"screen-saver"),i.setPosition(0,0),i.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),i}}),we={},Wt={};const Fn=require("./$.node"),qn=Fn.getIcon;var Vn=Object.freeze(Object.defineProperty({__proto__:null,getIcon:qn},Symbol.toStringTag,{value:"Module"})),Nn=sr(Vn);const Qt=Le.default;let at;(Qt.platform()==="win32"||Qt.platform()==="darwin")&&(at=Nn.getIcon);const Jn=(t,e=64)=>{if(!!at)return at(t,e)};var Hn=Jn,Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});const te=we,Zn=Le.default,tt=t=>{if(!(!te.addon||!te.addon.getMonitorInfo))return te.addon.getMonitorInfo(t)};class Kn{constructor(e){this.id=e}getBounds(){return tt(this.id).bounds}getWorkArea(){return tt(this.id).workArea}isPrimary(){return tt(this.id).isPrimary}getScaleFactor(){if(!te.addon||!te.addon.getMonitorScaleFactor)return;const e=Zn.release().split(".").map(r=>parseInt(r,10));return e[0]>8||e[0]===8&&e[1]>=1?te.addon.getMonitorScaleFactor(this.id):1}isValid(){return te.addon&&te.addon.getMonitorInfo}}Ke.Monitor=Kn;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});class Gn{getBounds(){return{x:0,y:0,width:0,height:0}}getWorkArea(){return{x:0,y:0,width:0,height:0}}isPrimary(){return!1}getScaleFactor(){return 1}isValid(){return!1}}Ge.EmptyMonitor=Gn;var Xn=ze&&ze.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Wt,"__esModule",{value:!0});const g=we,Yn=Xn(Hn),Qn=Ke,ei=Ge;class $e{constructor(e){if(!g.addon)return;this.id=e;const{processId:r,path:n}=g.addon.initWindow(e);this.processId=r,this.path=n}getBounds(){if(!g.addon)return;const e=g.addon.getWindowBounds(this.id);if(process.platform==="win32"){const r=this.getMonitor().getScaleFactor();e.x=Math.floor(e.x/r),e.y=Math.floor(e.y/r),e.width=Math.floor(e.width/r),e.height=Math.floor(e.height/r)}return e}setBounds(e){if(!g.addon)return;const r=Object.assign(Object.assign({},this.getBounds()),e);if(process.platform==="win32"){const n=this.getMonitor().getScaleFactor();r.x=Math.floor(r.x*n),r.y=Math.floor(r.y*n),r.width=Math.floor(r.width*n),r.height=Math.floor(r.height*n),g.addon.setWindowBounds(this.id,r)}else process.platform==="darwin"&&g.addon.setWindowBounds(this.id,r)}getTitle(){if(!!g.addon)return g.addon.getWindowTitle(this.id)}getMonitor(){return!g.addon||!g.addon.getMonitorFromWindow?new ei.EmptyMonitor:new Qn.Monitor(g.addon.getMonitorFromWindow(this.id))}show(){!g.addon||!g.addon.showWindow||g.addon.showWindow(this.id,"show")}hide(){!g.addon||!g.addon.showWindow||g.addon.showWindow(this.id,"hide")}minimize(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"minimize"):process.platform==="darwin"&&g.addon.setWindowMinimized(this.id,!0))}restore(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"restore"):process.platform==="darwin"&&g.addon.setWindowMinimized(this.id,!1))}maximize(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"maximize"):process.platform==="darwin"&&g.addon.setWindowMaximized(this.id))}bringToTop(){!g.addon||(process.platform==="darwin"?g.addon.bringWindowToTop(this.id,this.processId):g.addon.bringWindowToTop(this.id))}redraw(){!g.addon||!g.addon.redrawWindow||g.addon.redrawWindow(this.id)}isWindow(){if(!!g.addon){if(process.platform==="win32")return this.path&&this.path!==""&&g.addon.isWindow(this.id);if(process.platform==="darwin")return this.path&&this.path!==""&&!!g.addon.initWindow(this.id)}}isVisible(){return!g.addon||!g.addon.isWindowVisible?!0:g.addon.isWindowVisible(this.id)}toggleTransparency(e){!g.addon||!g.addon.toggleWindowTransparency||g.addon.toggleWindowTransparency(this.id,e)}setOpacity(e){!g.addon||!g.addon.setWindowOpacity||g.addon.setWindowOpacity(this.id,e)}getOpacity(){return!g.addon||!g.addon.getWindowOpacity?1:g.addon.getWindowOpacity(this.id)}getIcon(e=64){return Yn.default(this.path,e)}setOwner(e){if(!g.addon||!g.addon.setWindowOwner)return;let r=e;e instanceof $e?r=e.id:e||(r=0),g.addon.setWindowOwner(this.id,r)}getOwner(){if(!(!g.addon||!g.addon.getWindowOwner))return new $e(g.addon.getWindowOwner(this.id))}}Wt.Window=$e;const Y=require("./-.node"),ti=Y.getWindows,ri=Y.getActiveWindow,ni=Y.setWindowBounds,ii=Y.getWindowBounds,si=Y.getWindowTitle,oi=Y.initWindow,ai=Y.bringWindowToTop,li=Y.setWindowMinimized,fi=Y.setWindowMaximized,ui=Y.requestAccessibility;var di=Object.freeze(Object.defineProperty({__proto__:null,getWindows:ti,getActiveWindow:ri,setWindowBounds:ni,getWindowBounds:ii,getWindowTitle:si,initWindow:oi,bringWindowToTop:ai,setWindowMinimized:li,setWindowMaximized:fi,requestAccessibility:ui},Symbol.toStringTag,{value:"Module"})),ci=sr(di),hi=ze&&ze.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(f){f(a)})}return new(r||(r=Promise))(function(a,f){function x(_){try{b(n.next(_))}catch(v){f(v)}}function p(_){try{b(n.throw(_))}catch(v){f(v)}}function b(_){_.done?a(_.value):i(_.value).then(x,p)}b((n=n.apply(t,e||[])).next())})};Object.defineProperty(we,"__esModule",{value:!0});const je=Wt;we.Window=je.Window;const wi=ln.default,er=Le.default,xi=Ke,pi=Ge;let R;we.addon=R;(er.platform()==="win32"||er.platform()==="darwin")&&(we.addon=R=ci);let tr=null,Pe=[];class gi extends wi.EventEmitter{constructor(){super(),this.requestAccessibility=()=>!R||!R.requestAccessibility?!0:R.requestAccessibility(),this.getActiveWindow=()=>{if(!!R)return new je.Window(R.getActiveWindow())},this.getWindows=()=>!R||!R.getWindows?[]:R.getWindows().map(r=>new je.Window(r)).filter(r=>r.isWindow()),this.getMonitors=()=>!R||!R.getMonitors?[]:R.getMonitors().map(r=>new xi.Monitor(r)),this.getPrimaryMonitor=()=>process.platform==="win32"?this.getMonitors().find(r=>r.isPrimary):new pi.EmptyMonitor,this.createProcess=(r,n="")=>{if(!(!R||!R.createProcess))return R.createProcess(r,n)};let e;!R||(this.on("newListener",r=>{if(r==="window-activated"&&(e=R.getActiveWindow()),Pe.indexOf(r)===-1){if(r==="window-activated")tr=setInterval(()=>hi(this,void 0,void 0,function*(){const n=R.getActiveWindow();e!==n&&(e=n,this.emit("window-activated",new je.Window(n)))}),50);else return;Pe.push(r)}}),this.on("removeListener",r=>{this.listenerCount(r)>0||(r==="window-activated"&&clearInterval(tr),Pe=Pe.filter(n=>n!==r))}))}}const yi=new gi;var Vr=we.windowManager=yi,Mt,ie,lt,Tt,Nr,Jr,Hr,Zr,j;({recbar:Zr}=me);j=void 0;ie=void 0;({draw:Hr}=kt);var mi=()=>{ie||(ie=Hr(),ie.on("close",()=>ie=void 0),Kr())},Kr=()=>{We(),ie.focus()},vi=()=>{he(ie),ie=void 0};lt=["CommandOrControl+R","CommandOrControl+W","CommandOrControl+Q","Alt+F4","F5"];Mt={"browser-window-focus":()=>{var t;for(t of lt)S.globalShortcut.register(t,()=>{})},"browser-window-blur":()=>{var t;for(t of lt)S.globalShortcut.unregister(t,()=>{})}};var Bt=t=>{var e;return t==="camera"?e=500:e=600,Nr(e)};Nr=t=>{var e,r,n,i,a,f,x,p;a=Object.entries(Mt);for(p of a)[n,e]=p,S.app.on(n,e);return En(),r=48,i={roundedCorners:!1,transparent:!0,resizable:!1,width:t,height:r},j=Zr(i),j.on("close",()=>j=void 0),{width:x,height:f}=S.screen.getPrimaryDisplay().workArea,j.setBounds({x:Math.round((x-t)/2),y:f-28-r,width:t,height:r}),We(),Ot(),new Promise(b=>j.webContents.on("did-finish-load",()=>{We(),j.focus(),b(j)}))};var We=()=>{j&&(j.setAlwaysOnTop(!0,"screen-saver"),j.moveTop())},bi=()=>{var t,e,r,n,i;n=j.getPosition(),[r,e]=j.getSize(),[i,t]=j.size,j.setBounds({x:n[0]+r-i,y:n[1],width:i,height:t})},Si=()=>{var t,e,r,n;e=j.getPosition(),j.size=r=j.getSize(),n=162,t=48,j.setBounds({x:e[0]+r[0]-n,y:e[1],width:n,height:t})};Tt=()=>{var t,e,r,n;r=Object.entries(Mt);for(n of r)[e,t]=n,S.app.off(e,t);zr(),qr()};var _i=()=>{Tt(),He("show")},Oi=()=>{Tt(),He()},ki=()=>{j.hide()};Jr=(...t)=>S.desktopCapturer.getSources({types:t,thumbnailSize:{width:0,height:0}});var Wi=async()=>{var t,e;e=await Jr("screen");for(t of e)return t.id},Mi=async()=>{var t,e,r,n,i,a,f,x,p,b,_,v,T,M,E;({bounds:t}=S.screen.getPrimaryDisplay()),{scaleFactor:_}=S.screen.getPrimaryDisplay(),a=new Map,p=await S.desktopCapturer.getSources({types:["window"],fetchWindowIcons:!1,thumbnailSize:{width:320*_,height:180*_}});for(n of p)a.set(Math.floor(n.id.split(":")[1]),[n.thumbnail.toDataURL(),n.name]);x=[],b=Vr.getWindows();for(n of b)if({id:i}=n,!process.execPath.startsWith(n.path)&&(f=a.get(i),f)){if({x:M,y:E,width:T,height:r}=n.getBounds(),M+T<=0&&M<=0||M+T>t.width&&M>t.width||E+r<=0&&E<=0||E+r>t.height&&E>t.height)continue;v=t.width-M,T>v&&(T=v),e=t.height-E,r>e&&(r=e),M<0&&(M=0),E<0&&(E=0),x.push(f.concat([i,M,E,T,r]))}return x},Ti=t=>{S.BrowserWindow.getAllWindows().forEach(e=>{var r;if({hash:r}=new URL(e.webContents.getURL()),!t&&r.slice(1)==="camera"){he(e);return}return e.hide()})},Bi=Object.freeze(Object.defineProperty({__proto__:null,draw:mi,draw_top:Kr,draw_x:vi,工具条:Bt,top:We,expand:bi,left:Si,cancel:_i,end:Oi,hide:ki,screen_source:Wi,win_source:Mi,stop:Ti},Symbol.toStringTag,{value:"Module"})),Gr,F;({count_down:Gr}=me);F=void 0;var Xr=()=>{var t;if(F){F.focus();return}t=240,F=Gr({width:t,height:t,transparent:!0,resizable:!1,hasShadow:!1}),F.on("close",()=>{F=void 0}),F.setAlwaysOnTop(!0,"screen-saver"),F.on("show",()=>{var e,r,n,i;i=S.BrowserWindow.getAllWindows();for(r of i)r.webContents.getURL().endsWith("/#main")||r.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0});n=setInterval(()=>F?F.moveTop():e(),300),e=()=>{clearInterval(n)},F.on("hide",e),F.on("close",e)})},Ui={hide:()=>{F!=null&&F.hide()},close:()=>{F!=null&&F.close(),We()}};var Me,Ut,At,Pt,It;Me=At=Ut=void 0;Pt=()=>{Ut=new Promise(t=>{At=t})};Pt();It=t=>{Me.once("closed",()=>{At(t),Pt()}),he(Me)};var Ai=()=>{It(!0)},Pi=()=>{It(!1)},Ii=t=>(Me=kt["confirm_"+t]({width:275,height:190,modal:!0,isAlwaysOnTop:!0,visibleOnAllWorkspaces:!0}),Me.setAlwaysOnTop(!0,"screen-saver"),Ut),Ei=Object.freeze(Object.defineProperty({__proto__:null,y:Ai,n:Pi,show:Ii},Symbol.toStringTag,{value:"Module"})),ji=t=>{lr.ID=t},Di=Object.freeze(Object.defineProperty({__proto__:null,ID:ji},Symbol.toStringTag,{value:"Module"})),zi=function(){var t,e,r;return r=this.sender.getOwnerBrowserWindow(),e=r.getBounds(),t=n=>{var i,a;if(a=r[n],i=e[n],a&&i>a&&i-a<3){e[n]=a;return}r[n]=i},["height","width"].map(t),e},Ri=function(t,e,r,n){var i;i=this.sender.getOwnerBrowserWindow(),i.setBounds({x:Math.round(t),y:Math.round(e),width:r,height:n})},Ci=Object.freeze(Object.defineProperty({__proto__:null,getBounds:zi,setBounds:Ri},Symbol.toStringTag,{value:"Module"}));var Yr,Et,jt,ce,Qr;({area:Yr,win_area:Qr}=kt);ce=void 0;var $i=t=>{var e,r,n;r=void 0,n=Vr.getWindows();for(e of n)if(t===e.id){r=e;break}r&&(ce.setAlwaysOnTop(!1),r.bringToTop(),jt())};jt=()=>{ce.setAlwaysOnTop(!0,"screen-saver")};Et=t=>{ce=t(),jt(),ce.on("close",()=>ce=void 0)};var Li=()=>Et(Qr),Fi=()=>Et(Yr),qi=()=>{Bt(),ce.setIgnoreMouseEvents(!0,{forward:!0}),Xr()},Vi=()=>{var t,e;return{x:t,y:e}=S.screen.getCursorScreenPoint(),[t,e]};function Ni(t,e,r,n){var i;if(i=t==="camera",!i&&n){[Li,Fi][n-1]();return}else Xr();Bt(t)}var Ji=(t,e,r,n)=>{He(),Ni(t,e,r,n)},Hi=t=>{S.shell.openExternal(t)},Zi=()=>nr.ROOT,Ki=Object.freeze(Object.defineProperty({__proto__:null,userData:Zi,close:He,x:Dn,count_down:Ui,confirm:Ei,auto_update:Pn,recbar:Bi,USER:Di,camera:Ln,drag:Ci,area:qi,wintop:$i,main:ge,mouse:Vi,rec:Ji,open:Hi},Symbol.toStringTag,{value:"Module"}));process.on("exit",()=>{S.app.quit()});S.app.requestSingleInstanceLock()||(S.app.quit(),process.exit(0));(async()=>{var t;t=await Promise.resolve().then(function(){return require("./e.js")}),t.init({dsn:"https://54c0fbe278e049c8a9635fc0fa612836@sentry.dalukuankuan.com/6"})})();S.app.commandLine.appendSwitch("webrtc-max-cpu-consumption-percentage","100");S.app.commandLine.appendSwitch("js-flags","--expose_gc --max-old-space-size=512");(()=>{var t,e,r,n,i;ge(),t=(a,f)=>{var x,p,b,_;f instanceof Function&&S.ipcMain.handle(a.join("."),(v,T)=>f.apply(v,T)),b=Object.entries(f);for(_ of b)[p,x]=_,t([...a,p],x)},r=Object.entries(Ki);for(i of r)[e,n]=i,t([e],n);zr(),jn()})();un(S.app,{"second-instance":()=>{var t;t=!0,S.BrowserWindow.getAllWindows().forEach(e=>{var r,n;n=e.webContents.getURL();try{({hash:r}=new URL(n))}catch{return}r.startsWith("#recbar")&&(t=!1)}),t&&ge()},activate:ge});
