"use strict";var cn=Object.defineProperty;var Vt=Object.getOwnPropertySymbols;var dn=Object.prototype.hasOwnProperty,hn=Object.prototype.propertyIsEnumerable;var Nt=(t,e,r)=>e in t?cn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jt=(t,e)=>{for(var r in e||(e={}))dn.call(e,r)&&Nt(t,r,e[r]);if(Vt)for(var r of Vt(e))hn.call(e,r)&&Nt(t,r,e[r]);return t};var y=require("electron"),wn=require("os"),te=require("fs"),V=require("path"),pn=require("crypto"),dr=require("zlib"),xn=require("util"),ae=require("./$.js"),Oe=require("fs/promises"),$e=require("./z.js"),hr=require("./$!.js"),gn=require("events");function wr(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var ce=wr(wn),yn=wr(gn),re=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};var mn="win32",we=t=>{if(!!t&&!t.isDestroyed()){t.close();try{t.destroy()}catch{}}},vn=(t,e)=>{var r,n;for(r in e)n=e[r],t.on(r,n);return t},pr;pr=V.dirname(__dirname);pt=wt=ht=__dirname;V.dirname(pr);var ht=ht,wt=wt,pt=pt,tt,xr;tt="127.0.0.1",xr="http://"+tt,y.session.defaultSession.protocol.interceptStreamProtocol("http",(t,e)=>{var r,n,i,a,f,w,p,S,_;if(_=new URL(t.url),_.host===tt)({pathname:f}=_),f==="/"&&(f+=".htm"),S=f.slice(f.lastIndexOf(".")+1),S.startsWith("htm")?a="text/html":a={js:"text/javascript",css:"text/css",svg:"image/svg+xml",woff2:"font/woff2"}[S]||"application/octet-stream",n=te.createReadStream(wt+f),e({data:n,statusCode:200,headers:{"content-type":a}});else{if(t.useSessionCookies=!0,t.partition="persist:I",w=y.net.request(t),w.on("response",b=>{var U,P;({headers:U,statusCode:P}=b),e({data:b},U,P)}),t.uploadData){p=t.uploadData;for(i of p)({bytes:r}=i),r&&w.write(r)}w.end()}});var be=new Proxy({},{get:(t,e)=>r=>{var n;return r=Jt({skipTaskbar:!0,frame:!1,minimizable:!1,maximizable:!1,fullscreenable:!1,type:"toolbar",shadow:!1,hasShadow:!1,transparent:!0,webPreferences:{preload:V.join(ht,"w.js"),webSecurity:!1}},r),n=new y.BrowserWindow(r),n.setMenu(null),e!=="main"&&n.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),n.loadURL(xr+"#"+e),n.once("ready-to-show",()=>{n.show()}),n.focus(),n}}),Ve=t=>{y.BrowserWindow.getAllWindows().forEach(e=>{var r,n;if(n=e.webContents.getURL(),n){if({hash:r}=new URL(n),r=r.slice(1),r.startsWith("main")){t?(e[t](),t==="show"&&e.once("show",()=>{e.setAlwaysOnTop(!0,"screen-saver"),setTimeout(()=>e.setAlwaysOnTop(!1,"screen-saver"),1e3)})):e.hide();return}if(r.startsWith("camera"))return}we(e)})},gr=()=>{y.BrowserWindow.getAllWindows().forEach(t=>{var e,r;if(r=t.webContents.getURL(),r&&({hash:e}=new URL(r),e=e.slice(1),e.startsWith("main"))){t.hide();return}we(t)})},bn="帧想",yr;({main:yr}=be);var ye=(t=!0)=>{var e,r,n,i;if(r=y.BrowserWindow.getAllWindows(),r.length)for(e of r)switch(n=e.webContents.getURL().split("/#").pop(),n){case"main":i=e;break;case"recbar":case"win_area":case"area":return}i?(i.isMinimized(),i.restore()):(i=yr({type:"",resizable:!1,height:645,width:426,skipTaskbar:!1}),i.setAppDetails({appId:bn,appIconPath:process.execPath}),i.on("close",a=>{y.app.quiting||(a.preventDefault(),gr())})),!(!t&&!i.isVisible())&&(i.show(),i.moveTop(),i.focus())},mr={ID:""},Sn="x64",st;try{st=new TextDecoder}catch{}var h,se,s=0,N={},T,ne,H=0,X=0,L,Q,J=[],M,Gt={useRecords:!1,mapsAsObjects:!0};class vr{}const br=new vr;br.name="MessagePack 0xC1";var me=!1,Sr=2;try{new Function("")}catch{Sr=1/0}class ke{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,r){if(h)return Pr(()=>(ot(),this?this.unpack(e,r):ke.prototype.unpack.call(Gt,e,r)));se=r>-1?r:e.length,s=0,X=0,ne=null,L=null,h=e;try{M=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw h=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof ke){if(N=this,this.structures)return T=this.structures,Ie();(!T||T.length>0)&&(T=[])}else N=Gt,(!T||T.length>0)&&(T=[]);return Ie()}unpackMultiple(e,r){let n,i=0;try{me=!0;let a=e.length,f=this?this.unpack(e,a):Ne.unpack(e,a);if(r){for(r(f);s<a;)if(i=s,r(Ie())===!1)return}else{for(n=[f];s<a;)i=s,n.push(Ie());return n}}catch(a){throw a.lastPosition=i,a.values=n,a}finally{me=!1,ot()}}_mergeStructures(e,r){e=e||[];for(let n=0,i=e.length;n<i;n++){let a=e[n];a&&(a.isShared=!0,n>=32&&(a.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in r||[])if(n>=0){let i=e[n],a=r[n];a&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=a)}return this.structures=e}decode(e,r){return this.unpack(e,r)}}function Ie(){try{if(!N.trusted&&!me){let e=T.sharedLength||0;e<T.length&&(T.length=e)}let t=D();if(L&&(s=L.postBundlePosition),s==se)T.restoreStructures&&Ht(),T=null,h=null,Q&&(Q=null);else if(s>se){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!me)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw T.restoreStructures&&Ht(),ot(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function Ht(){for(let t in T.restoreStructures)T[t]=T.restoreStructures[t];T.restoreStructures=null}function D(){let t=h[s++];if(t<160)if(t<128){if(t<64)return t;{let e=T[t&63]||N.getStructures&&_r()[t&63];return e?(e.read||(e.read=xt(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,N.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[kr()]=D();return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(D(),D());return e}else{t-=144;let e=new Array(t);for(let r=0;r<t;r++)e[r]=D();return e}else if(t<192){let e=t-160;if(X>=s)return ne.slice(s-H,(s+=e)-H);if(X==0&&se<140){let r=e<16?gt(e):Or(e);if(r!=null)return r}return at(e)}else{let e;switch(t){case 192:return null;case 193:return L?(e=D(),e>0?L[1].slice(L.position1,L.position1+=e):L[0].slice(L.position0,L.position0-=e)):br;case 194:return!1;case 195:return!0;case 196:return rt(h[s++]);case 197:return e=M.getUint16(s),s+=2,rt(e);case 198:return e=M.getUint32(s),s+=4,rt(e);case 199:return ue(h[s++]);case 200:return e=M.getUint16(s),s+=2,ue(e);case 201:return e=M.getUint32(s),s+=4,ue(e);case 202:if(e=M.getFloat32(s),N.useFloat32>2){let r=yt[(h[s]&127)<<1|h[s+1]>>7];return s+=4,(r*e+(e>0?.5:-.5)>>0)/r}return s+=4,e;case 203:return e=M.getFloat64(s),s+=8,e;case 204:return h[s++];case 205:return e=M.getUint16(s),s+=2,e;case 206:return e=M.getUint32(s),s+=4,e;case 207:return N.int64AsNumber?(e=M.getUint32(s)*4294967296,e+=M.getUint32(s+4)):e=M.getBigUint64(s),s+=8,e;case 208:return M.getInt8(s++);case 209:return e=M.getInt16(s),s+=2,e;case 210:return e=M.getInt32(s),s+=4,e;case 211:return N.int64AsNumber?(e=M.getInt32(s)*4294967296,e+=M.getUint32(s+4)):e=M.getBigInt64(s),s+=8,e;case 212:if(e=h[s++],e==114)return er(h[s++]&63);{let r=J[e];if(r)return r.read?(s++,r.read(D())):r.noBuffer?(s++,r()):r(h.subarray(s,++s));throw new Error("Unknown extension "+e)}case 213:return e=h[s],e==114?(s++,er(h[s++]&63,h[s++])):ue(2);case 214:return ue(4);case 215:return ue(8);case 216:return ue(16);case 217:return e=h[s++],X>=s?ne.slice(s-H,(s+=e)-H):On(e);case 218:return e=M.getUint16(s),s+=2,X>=s?ne.slice(s-H,(s+=e)-H):kn(e);case 219:return e=M.getUint32(s),s+=4,X>=s?ne.slice(s-H,(s+=e)-H):Mn(e);case 220:return e=M.getUint16(s),s+=2,Kt(e);case 221:return e=M.getUint32(s),s+=4,Kt(e);case 222:return e=M.getUint16(s),s+=2,Xt(e);case 223:return e=M.getUint32(s),s+=4,Xt(e);default:if(t>=224)return t-256;if(t===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+t)}}}const _n=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function xt(t,e){function r(){if(r.count++>Sr){let i=t.read=new Function("r","return function(){return {"+t.map(a=>_n.test(a)?a+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}}")(D);return t.highByte===0&&(t.read=Zt(e,t.read)),i()}let n={};for(let i=0,a=t.length;i<a;i++){let f=t[i];n[f]=D()}return n}return r.count=0,t.highByte===0?Zt(e,r):r}const Zt=(t,e)=>function(){let r=h[s++];if(r===0)return e();let n=t<32?-(t+(r<<5)):t+(r<<5),i=T[n]||_r()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=xt(i,t)),i.read()};function _r(){let t=Pr(()=>(h=null,N.getStructures()));return T=N._mergeStructures(t,T)}var at=Ue,On=Ue,kn=Ue,Mn=Ue;function Ue(t){let e;if(t<16&&(e=gt(t)))return e;if(t>64&&st)return st.decode(h.subarray(s,s+=t));const r=s+t,n=[];for(e="";s<r;){const i=h[s++];if((i&128)===0)n.push(i);else if((i&224)===192){const a=h[s++]&63;n.push((i&31)<<6|a)}else if((i&240)===224){const a=h[s++]&63,f=h[s++]&63;n.push((i&31)<<12|a<<6|f)}else if((i&248)===240){const a=h[s++]&63,f=h[s++]&63,w=h[s++]&63;let p=(i&7)<<18|a<<12|f<<6|w;p>65535&&(p-=65536,n.push(p>>>10&1023|55296),p=56320|p&1023),n.push(p)}else n.push(i);n.length>=4096&&(e+=C.apply(String,n),n.length=0)}return n.length>0&&(e+=C.apply(String,n)),e}function Kt(t){let e=new Array(t);for(let r=0;r<t;r++)e[r]=D();return e}function Xt(t){if(N.mapsAsObjects){let e={};for(let r=0;r<t;r++)e[kr()]=D();return e}else{let e=new Map;for(let r=0;r<t;r++)e.set(D(),D());return e}}var C=String.fromCharCode;function Or(t){let e=s,r=new Array(t);for(let n=0;n<t;n++){const i=h[s++];if((i&128)>0){s=e;return}r[n]=i}return C.apply(String,r)}function gt(t){if(t<4)if(t<2){if(t===0)return"";{let e=h[s++];if((e&128)>1){s-=1;return}return C(e)}}else{let e=h[s++],r=h[s++];if((e&128)>0||(r&128)>0){s-=2;return}if(t<3)return C(e,r);let n=h[s++];if((n&128)>0){s-=3;return}return C(e,r,n)}else{let e=h[s++],r=h[s++],n=h[s++],i=h[s++];if((e&128)>0||(r&128)>0||(n&128)>0||(i&128)>0){s-=4;return}if(t<6){if(t===4)return C(e,r,n,i);{let a=h[s++];if((a&128)>0){s-=5;return}return C(e,r,n,i,a)}}else if(t<8){let a=h[s++],f=h[s++];if((a&128)>0||(f&128)>0){s-=6;return}if(t<7)return C(e,r,n,i,a,f);let w=h[s++];if((w&128)>0){s-=7;return}return C(e,r,n,i,a,f,w)}else{let a=h[s++],f=h[s++],w=h[s++],p=h[s++];if((a&128)>0||(f&128)>0||(w&128)>0||(p&128)>0){s-=8;return}if(t<10){if(t===8)return C(e,r,n,i,a,f,w,p);{let S=h[s++];if((S&128)>0){s-=9;return}return C(e,r,n,i,a,f,w,p,S)}}else if(t<12){let S=h[s++],_=h[s++];if((S&128)>0||(_&128)>0){s-=10;return}if(t<11)return C(e,r,n,i,a,f,w,p,S,_);let b=h[s++];if((b&128)>0){s-=11;return}return C(e,r,n,i,a,f,w,p,S,_,b)}else{let S=h[s++],_=h[s++],b=h[s++],U=h[s++];if((S&128)>0||(_&128)>0||(b&128)>0||(U&128)>0){s-=12;return}if(t<14){if(t===12)return C(e,r,n,i,a,f,w,p,S,_,b,U);{let P=h[s++];if((P&128)>0){s-=13;return}return C(e,r,n,i,a,f,w,p,S,_,b,U,P)}}else{let P=h[s++],j=h[s++];if((P&128)>0||(j&128)>0){s-=14;return}if(t<15)return C(e,r,n,i,a,f,w,p,S,_,b,U,P,j);let Z=h[s++];if((Z&128)>0){s-=15;return}return C(e,r,n,i,a,f,w,p,S,_,b,U,P,j,Z)}}}}}function Yt(){let t=h[s++],e;if(t<192)e=t-160;else switch(t){case 217:e=h[s++];break;case 218:e=M.getUint16(s),s+=2;break;case 219:e=M.getUint32(s),s+=4;break;default:throw new Error("Expected string")}return Ue(e)}function rt(t){return N.copyBuffers?Uint8Array.prototype.slice.call(h,s,s+=t):h.subarray(s,s+=t)}function ue(t){let e=h[s++];if(J[e])return J[e](h.subarray(s,s+=t));throw new Error("Unknown extension type "+e)}var Qt=new Array(4096);function kr(){let t=h[s++];if(t>=160&&t<192){if(t=t-160,X>=s)return ne.slice(s-H,(s+=t)-H);if(!(X==0&&se<180))return at(t)}else return s--,D();let e=(t<<5^(t>1?M.getUint16(s):t>0?h[s]:0))&4095,r=Qt[e],n=s,i=s+t-3,a,f=0;if(r&&r.bytes==t){for(;n<i;){if(a=M.getUint32(n),a!=r[f++]){n=1879048192;break}n+=4}for(i+=3;n<i;)if(a=h[n++],a!=r[f++]){n=1879048192;break}if(n===i)return s=n,r.string;i-=3,n=s}for(r=[],Qt[e]=r,r.bytes=t;n<i;)a=M.getUint32(n),r.push(a),n+=4;for(i+=3;n<i;)a=h[n++],r.push(a);let w=t<16?gt(t):Or(t);return w!=null?r.string=w:r.string=at(t)}const er=(t,e)=>{var r=D();let n=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,r.highByte=e);let i=T[t];return i&&i.isShared&&((T.restoreStructures||(T.restoreStructures=[]))[t]=i),T[t]=r,r.read=xt(r,n),r.read()};var Mr=typeof self=="object"?self:global;J[0]=()=>{};J[0].noBuffer=!0;J[101]=()=>{let t=D();return(Mr[t[0]]||Error)(t[1])};J[105]=t=>{let e=M.getUint32(s-4);Q||(Q=new Map);let r=h[s],n;r>=144&&r<160||r==220||r==221?n=[]:n={};let i={target:n};Q.set(e,i);let a=D();return i.used?Object.assign(n,a):(i.target=a,a)};J[112]=t=>{let e=M.getUint32(s-4),r=Q.get(e);return r.used=!0,r.target};J[115]=()=>new Set(D());const Tr=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");J[116]=t=>{let e=t[0],r=Tr[e];if(!r)throw new Error("Could not find typed array for code "+e);return new Mr[r](Uint8Array.prototype.slice.call(t,1).buffer)};J[120]=()=>{let t=D();return new RegExp(t[0],t[1])};const Tn=[];J[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],r=s;return s+=e-t.length,L=Tn,L=[Yt(),Yt()],L.position0=0,L.position1=0,L.postBundlePosition=s,s=r,D()};J[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function Pr(t){let e=se,r=s,n=H,i=X,a=ne,f=Q,w=L,p=new Uint8Array(h.slice(0,se)),S=T,_=T.slice(0,T.length),b=N,U=me,P=t();return se=e,s=r,H=n,X=i,ne=a,Q=f,L=w,h=p,me=U,T=S,T.splice(0,T.length,..._),N=b,M=new DataView(h.buffer,h.byteOffset,h.byteLength),P}function ot(){h=null,Q=null,T=null}const yt=new Array(147);for(let t=0;t<256;t++)yt[t]=+("1e"+Math.floor(45.15-t*.30103));var Ne=new ke({useRecords:!1});const Pn=Ne.unpack;Ne.unpackMultiple;Ne.unpack;let Un=new Float32Array(1);new Uint8Array(Un.buffer,0,4);let je;try{je=new TextEncoder}catch{}let lt,Ur;const Je=typeof Buffer!="undefined",We=Je?Buffer.allocUnsafeSlow:Uint8Array,Br=Je?Buffer:Uint8Array,tr=Je?4294967296:2144337920;let l,_e,E,o=0,q,z=null;const Bn=61440,An=/[\u0080-\uFFFF]/,xe=Symbol("record-id");class In extends ke{constructor(e){super(e),this.offset=0;let r,n,i,a,f=0,w=Br.prototype.utf8Write?function(u,v,d){return l.utf8Write(u,v,d)}:je&&je.encodeInto?function(u,v){return je.encodeInto(u,l.subarray(v)).written}:!1,p=this;e||(e={});let S=e&&e.sequential,_=e.structures||e.saveStructures,b=e.maxSharedStructures;if(b==null&&(b=_?32:0),b>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(e.moreTypes=!0);let U=e.maxOwnStructures;U==null&&(U=_?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let P=b>32||U+b>64,j=b+64,Z=b+U+64;if(Z>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let G=[],oe=0,K=0;this.pack=this.encode=function(u,v){if(l||(l=new We(8192),E=new DataView(l.buffer,0,8192),o=0),q=l.length-10,q-o<2048?(l=new We(l.length),E=new DataView(l.buffer,0,l.length),q=l.length-10,o=0):o=o+7&2147483640,r=o,a=p.structuredClone?new Map:null,p.bundleStrings&&typeof u!="string"?(z=[],z.size=1/0):z=null,i=p.structures,i){i.uninitialized&&(i=p._mergeStructures(p.getStructures()));let d=i.sharedLength||0;if(d>b)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let c=0;c<d;c++){let x=i[c];if(!x)continue;let B,O=i.transitions;for(let m=0,R=x.length;m<R;m++){let I=x[m];B=O[I],B||(B=O[I]=Object.create(null)),O=B}O[xe]=c+64}f=d}S||(i.nextId=d+64)}n&&(n=!1);try{if(W(u),z&&ir(r,W),p.offset=o,a&&a.idsToInsert){o+=a.idsToInsert.length*6,o>q&&le(o),p.offset=o;let d=En(l.subarray(r,o),a.idsToInsert);return a=null,d}return v&jn?(l.start=r,l.end=o,l):l.subarray(r,o)}finally{if(i){K<10&&K++;let d=i.sharedLength||b;if(i.length>d&&(i.length=d),oe>1e4)i.transitions=null,K=0,oe=0,G.length>0&&(G=[]);else if(G.length>0&&!S){for(let c=0,x=G.length;c<x;c++)G[c][xe]=0;G=[]}if(n&&p.saveStructures){let c=l.subarray(r,o);return p.saveStructures(i,f)===!1?(p._mergeStructures(p.getStructures()),p.pack(u)):(f=d,c)}}v&Dn&&(o=r)}};const W=u=>{o>q&&(l=le(o));var v=typeof u,d;if(v==="string"){let c=u.length;if(z&&c>=4&&c<4096){if((z.size+=c)>Bn){let m,R=(z[0]?z[0].length*3+z[1].length:0)+10;o+R>q&&(l=le(o+R)),z.position?(l[o]=200,o+=3,l[o++]=98,m=o-r,o+=4,ir(r,W),E.setUint16(m+r-3,o-r-m)):(l[o++]=214,l[o++]=98,m=o-r,o+=4),z=["",""],z.size=0,z.position=m}let O=An.test(u);z[O?0:1]+=u,l[o++]=193,W(O?-c:c);return}let x;c<32?x=1:c<256?x=2:c<65536?x=3:x=5;let B=c*3;if(o+B>q&&(l=le(o+B)),c<64||!w){let O,m,R,I=o+x;for(O=0;O<c;O++)m=u.charCodeAt(O),m<128?l[I++]=m:m<2048?(l[I++]=m>>6|192,l[I++]=m&63|128):(m&64512)===55296&&((R=u.charCodeAt(O+1))&64512)===56320?(m=65536+((m&1023)<<10)+(R&1023),O++,l[I++]=m>>18|240,l[I++]=m>>12&63|128,l[I++]=m>>6&63|128,l[I++]=m&63|128):(l[I++]=m>>12|224,l[I++]=m>>6&63|128,l[I++]=m&63|128);d=I-o-x}else d=w(u,o+x,B);d<32?l[o++]=160|d:d<256?(x<2&&l.copyWithin(o+2,o+1,o+1+d),l[o++]=217,l[o++]=d):d<65536?(x<3&&l.copyWithin(o+3,o+2,o+2+d),l[o++]=218,l[o++]=d>>8,l[o++]=d&255):(x<5&&l.copyWithin(o+5,o+3,o+3+d),l[o++]=219,E.setUint32(o,d),o+=4),o+=d}else if(v==="number")if(u>>>0===u)u<64?l[o++]=u:u<256?(l[o++]=204,l[o++]=u):u<65536?(l[o++]=205,l[o++]=u>>8,l[o++]=u&255):(l[o++]=206,E.setUint32(o,u),o+=4);else if(u>>0===u)u>=-32?l[o++]=256+u:u>=-128?(l[o++]=208,l[o++]=u+256):u>=-32768?(l[o++]=209,E.setInt16(o,u),o+=2):(l[o++]=210,E.setInt32(o,u),o+=4);else{let c;if((c=this.useFloat32)>0&&u<4294967296&&u>=-2147483648){l[o++]=202,E.setFloat32(o,u);let x;if(c<4||(x=u*yt[(l[o]&127)<<1|l[o+1]>>7])>>0===x){o+=4;return}else o--}l[o++]=203,E.setFloat64(o,u),o+=8}else if(v==="object")if(!u)l[o++]=192;else{if(a){let x=a.get(u);if(x){if(!x.id){let B=a.idsToInsert||(a.idsToInsert=[]);x.id=B.push(x)}l[o++]=214,l[o++]=112,E.setUint32(o,x.id),o+=4;return}else a.set(u,{offset:o-r})}let c=u.constructor;if(c===Object)Ft(u,!0);else if(c===Array){d=u.length,d<16?l[o++]=144|d:d<65536?(l[o++]=220,l[o++]=d>>8,l[o++]=d&255):(l[o++]=221,E.setUint32(o,d),o+=4);for(let x=0;x<d;x++)W(u[x])}else if(c===Map){d=u.size,d<16?l[o++]=128|d:d<65536?(l[o++]=222,l[o++]=d>>8,l[o++]=d&255):(l[o++]=223,E.setUint32(o,d),o+=4);for(let[x,B]of u)W(x),W(B)}else{for(let x=0,B=lt.length;x<B;x++){let O=Ur[x];if(u instanceof O){let m=lt[x];if(m.write){m.type&&(l[o++]=212,l[o++]=m.type,l[o++]=0),W(m.write.call(this,u));return}let R=l,I=E,Y=o;l=null;let fe;try{fe=m.pack.call(this,u,Se=>(l=R,R=null,o+=Se,o>q&&le(o),{target:l,targetView:E,position:o-Se}),W)}finally{R&&(l=R,E=I,o=Y,q=l.length-10)}fe&&(fe.length+o>q&&le(fe.length+o),o=Wn(fe,l,o,m.type));return}}Ft(u,!u.hasOwnProperty)}}else if(v==="boolean")l[o++]=u?195:194;else if(v==="bigint"){if(u<BigInt(1)<<BigInt(63)&&u>=-(BigInt(1)<<BigInt(63)))l[o++]=211,E.setBigInt64(o,u);else if(u<BigInt(1)<<BigInt(64)&&u>0)l[o++]=207,E.setBigUint64(o,u);else if(this.largeBigIntToFloat)l[o++]=203,E.setFloat64(o,Number(u));else throw new RangeError(u+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");o+=8}else if(v==="undefined")this.encodeUndefinedAsNil?l[o++]=192:(l[o++]=212,l[o++]=0,l[o++]=0);else if(v==="function")W(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+v)},Ft=this.useRecords===!1?this.variableMapSize?u=>{let v=Object.keys(u),d=v.length;d<16?l[o++]=128|d:d<65536?(l[o++]=222,l[o++]=d>>8,l[o++]=d&255):(l[o++]=223,E.setUint32(o,d),o+=4);let c;for(let x=0;x<d;x++)W(c=v[x]),W(u[c])}:(u,v)=>{l[o++]=222;let d=o-r;o+=2;let c=0;for(let x in u)(v||u.hasOwnProperty(x))&&(W(x),W(u[x]),c++);l[d+++r]=c>>8,l[d+r]=c&255}:e.progressiveRecords&&!P?(u,v)=>{let d,c=i.transitions||(i.transitions=Object.create(null)),x=o++-r,B;for(let O in u)if(v||u.hasOwnProperty(O)){if(d=c[O],d)c=d;else{let m=Object.keys(u),R=c;c=i.transitions;let I=0;for(let Y=0,fe=m.length;Y<fe;Y++){let Se=m[Y];d=c[Se],d||(d=c[Se]=Object.create(null),I++),c=d}x+r+1==o?(o--,et(c,m,I)):qt(c,m,x,I),B=!0,c=R[O]}W(u[O])}if(!B){let O=c[xe];O?l[x+r]=O:qt(c,Object.keys(u),x,0)}}:(u,v)=>{let d,c=i.transitions||(i.transitions=Object.create(null)),x=0;for(let O in u)(v||u.hasOwnProperty(O))&&(d=c[O],d||(d=c[O]=Object.create(null),x++),c=d);let B=c[xe];B?B>=96&&P?(l[o++]=((B-=96)&31)+96,l[o++]=B>>5):l[o++]=B:et(c,c.__keys__||Object.keys(u),x);for(let O in u)(v||u.hasOwnProperty(O))&&W(u[O])},le=u=>{let v;if(u>16777216){if(u-r>tr)throw new Error("Packed buffer would be larger than maximum buffer size");v=Math.min(tr,Math.round(Math.max((u-r)*(u>67108864?1.25:2),4194304)/4096)*4096)}else v=(Math.max(u-r<<2,l.length-1)>>12)+1<<12;let d=new We(v);return E=new DataView(d.buffer,0,v),l.copy?l.copy(d,0,r,u):d.set(l.slice(r,u)),o-=r,r=0,q=d.length-10,l=d},et=(u,v,d)=>{let c=i.nextId;c||(c=64),c<j&&this.shouldShareStructure&&!this.shouldShareStructure(v)?(c=i.nextOwnId,c<Z||(c=j),i.nextOwnId=c+1):(c>=Z&&(c=j),i.nextId=c+1);let x=v.highByte=c>=96&&P?c-96>>5:-1;u[xe]=c,u.__keys__=v,i[c-64]=v,c<j?(v.isShared=!0,i.sharedLength=c-63,n=!0,x>=0?(l[o++]=(c&31)+96,l[o++]=x):l[o++]=c):(x>=0?(l[o++]=213,l[o++]=114,l[o++]=(c&31)+96,l[o++]=x):(l[o++]=212,l[o++]=114,l[o++]=c),d&&(oe+=K*d),G.length>=U&&(G.shift()[xe]=0),G.push(u),W(v))},qt=(u,v,d,c)=>{let x=l,B=o,O=q,m=r;l=_e,o=0,r=0,l||(_e=l=new We(8192)),q=l.length-10,et(u,v,c),_e=l;let R=o;if(l=x,o=B,q=O,r=m,R>1){let I=o+R-1;I>q&&le(I);let Y=d+r;l.copyWithin(Y+R,Y+1,o),l.set(_e.slice(0,R),Y),o=I}else l[d+r]=_e[0]}}useBuffer(e){l=e,E=new DataView(l.buffer,l.byteOffset,l.byteLength),o=0}clearSharedData(){this.structures&&(this.structures=[])}}Ur=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,vr];lt=[{pack(t,e,r){let n=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:i,targetView:a,position:f}=e(6);i[f++]=214,i[f++]=255,a.setUint32(f,n)}else if(n>0&&n<4294967296){let{target:i,targetView:a,position:f}=e(10);i[f++]=215,i[f++]=255,a.setUint32(f,t.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),a.setUint32(f+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),r(this.onInvalidDate());let{target:i,targetView:a,position:f}=e(3);i[f++]=212,i[f++]=255,i[f++]=255}else{let{target:i,targetView:a,position:f}=e(15);i[f++]=199,i[f++]=12,i[f++]=255,a.setUint32(f,t.getMilliseconds()*1e6),a.setBigInt64(f+4,BigInt(Math.floor(n)))}}},{pack(t,e,r){let n=Array.from(t),{target:i,position:a}=e(this.moreTypes?3:0);this.moreTypes&&(i[a++]=212,i[a++]=115,i[a++]=0),r(n)}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),r([t.name,t.message])}},{pack(t,e,r){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),r([t.source,t.flags])}},{pack(t,e){this.moreTypes?rr(t,16,e):nr(Je?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let r=t.constructor;r!==Br&&this.moreTypes?rr(t,Tr.indexOf(r.name),e):nr(t,e)}},{pack(t,e){let{target:r,position:n}=e(1);r[n]=193}}];function rr(t,e,r,n){let i=t.byteLength;if(i+1<256){var{target:a,position:f}=r(4+i);a[f++]=199,a[f++]=i+1}else if(i+1<65536){var{target:a,position:f}=r(5+i);a[f++]=200,a[f++]=i+1>>8,a[f++]=i+1&255}else{var{target:a,position:f,targetView:w}=r(7+i);a[f++]=201,w.setUint32(f,i+1),f+=4}a[f++]=116,a[f++]=e,a.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),f)}function nr(t,e){let r=t.byteLength;var n,i;if(r<256){var{target:n,position:i}=e(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=e(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=r&255}else{var{target:n,position:i,targetView:a}=e(r+5);n[i++]=198,a.setUint32(i,r),i+=4}n.set(t,i)}function Wn(t,e,r,n){let i=t.length;switch(i){case 1:e[r++]=212;break;case 2:e[r++]=213;break;case 4:e[r++]=214;break;case 8:e[r++]=215;break;case 16:e[r++]=216;break;default:i<256?(e[r++]=199,e[r++]=i):i<65536?(e[r++]=200,e[r++]=i>>8,e[r++]=i&255):(e[r++]=201,e[r++]=i>>24,e[r++]=i>>16&255,e[r++]=i>>8&255,e[r++]=i&255)}return e[r++]=n,e.set(t,r),r+=i,r}function En(t,e){let r,n=e.length*6,i=t.length-n;for(e.sort((a,f)=>a.offset>f.offset?1:-1);r=e.pop();){let a=r.offset,f=r.id;t.copyWithin(a+n,a,i),n-=6;let w=a+n;t[w++]=214,t[w++]=105,t[w++]=f>>24,t[w++]=f>>16&255,t[w++]=f>>8&255,t[w++]=f&255,i=a}return t}function ir(t,e){E.setUint32(z.position+t,o-z.position-t);let r=z;z=null,e(r[0]),e(r[1])}let Ar=new In({useRecords:!1});Ar.pack;Ar.pack;const jn=512,Dn=1024;var Rn="https://izx.dalukuankuan.com/",Ir="https://i-desk-ver.izhenxiang.com/",Wr,$n=async t=>{var e,r;return t=await t,r=[],e=r.push.bind(r),t.on("data",e),new Promise((n,i)=>(t.on("end",()=>{n(Buffer.concat(r))}),t.on("error",i)))},Cn=t=>$n(Er(t));Wr=t=>{var e;return e=y.net.request(t),e.end(),new Promise((r,n)=>(e.on("error",i=>{n(i)}),e.on("response",i=>{if(i.statusCode!==200){n(i);return}r(i)})))};var Er=t=>Wr(t),Be={};Be.version="1.0.0";Be.encode=function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};Be.decode=function(e){return e+=Array(5-e.length%4).join("="),e=e.replace(/\-/g,"+").replace(/\_/g,"/"),new Buffer(e,"base64")};Be.validate=function(e){return/^[A-Za-z0-9\-_]+$/.test(e)};var nt=Be;var ge,jr,De,Ge,mt,Me,vt,Dr,Rr,bt,Ce,$r,St,_t,ze,ft,He;Rr=xn.promisify(dr.brotliDecompress);var zn=()=>(y.app.relaunch(),y.app.exit());ge=V.join(hr.ROOT,"v");te.mkdirSync(ge,{recursive:!0});jr="sha512";ze=void 0;var Cr=()=>{we(ze),ze=void 0},zr=()=>{Cr(),ze=be.update({width:400,height:500,resizable:!1})};Ce=t=>Cn(Ir+t);$r=t=>{var e;return e=pn.createHash(jr),new Promise(r=>te.createReadStream(t).on("data",e.update.bind(e)).on("end",()=>{r(e.digest().slice(0,8))}))};ft=(()=>{var t;return{v:t}=$e.default,t&&ae.decode(t)})();var Ot=()=>ae.PACKAGE_JSON().version,Ln=async()=>["desk",await Ot(),ce.default.type(),ce.default.release(),ce.default.arch(),"ol"].join(" ");vt=mn+"/"+Sn+"/";He=ae.ver_int(Ot());Me=0;_t=async()=>{var t,e;t=ae.encode(parseInt(new Date/1e3)),e=vt+"v?"+t;try{Me=await Ce(e)}catch{console.error("❌",e)}return Me};Dr=async t=>{var e,r,n,i,a,f,w,p,S,_,b,U,P,j,Z,G,oe,K;if(t||(t=Me||await _t()),!!t&&(K=t.readUintBE(0,6),!(He>=K))){if(n=ae.encode(K),e=V.join(ge,n),te.existsSync(V.join(e,ae.package_json))&&K===ft)return e;for(G=nt.encode(await Ce(vt+nt.encode(t))),[r,i,w]=Pn(await Rr(await Ce(G))),U=W=>Oe.mkdir(V.join(e,W),{recursive:!0}),await Promise.all(r.map(U)),j=V.dirname(__dirname),P=S=0,_=i.length;S<_;P=++S)if(p=i[P],a=V.join(e,p),f=w[P],Z=async W=>Buffer.compare(f,await $r(W))===0,!(te.existsSync(a)&&await Z(a))){if(await U(V.dirname(p)),b=V.join(j,p),te.existsSync(b)&&await Z(b)){await Oe.copyFile(b,a);continue}if(oe=te.createWriteStream(a),(await Er(Ir+nt.encode(f))).pipe(dr.createBrotliDecompress()).pipe(oe),await new Promise(W=>{oe.on("finish",W)}),!await Z(a))return}return $e.default.v=n,ft=K,e}};var Lr=async()=>{var t,e;return t=await _t(),t&&(e=He<t.readUintBE(0,6),e)?t:0};bt=async()=>{var t;(t=await Lr())&&await Fr(t)};setInterval(bt,864e5);De=Ge=mt=void 0;St=()=>Ge=new Promise(t=>mt=t);St();var Fn=()=>Ge,Fr=(...t)=>(De||(De=Dr(...t).then(async e=>{e&&(mt([Me,JSON.parse(await Oe.readFile(V.join(e,ae.package_json),"utf8")).description]),St())}).finally(()=>{De=!1})),Ge);setTimeout(async()=>{var t,e,r,n;if(te.existsSync(ge)){n=await Oe.readdir(ge,{withFileTypes:!0});for(e of n)e.isDirectory()&&({name:r}=e,ae.decode(r)<He&&await Oe.rm(V.join(ge,r),{recursive:!0,force:!0}))}if(t=parseInt(new Date/864e5),t!==$e.default.update_check)return $e.default.update_check=t,await bt()},15e3);var qn=Object.freeze(Object.defineProperty({__proto__:null,relaunch:zn,x:Cr,show:zr,ver_now:Ot,ua_now:Ln,update_check:Lr,update_promise:Fn,update:Fr},Symbol.toStringTag,{value:"Module"}));var Ze,kt,qr,ut,Mt,Vn,Tt,Vr,Nr,Te;ce.default.platform();({Menu:kt,Tray:qr,app:ut,globalShortcut:Vn}=require("electron"));Te=new qr(V.join(pt,"trayTemplate.png"));Tt=[{label:"我的空间",click:()=>{y.shell.openExternal(Rn+"video_library.html?user_token="+mr.ID)}},{label:"检测更新",click:zr},{type:"separator"}];Ze=Vr=kt.buildFromTemplate([{label:"显示界面",click:ye},...Tt,{label:"退出",click:()=>(ut.quiting=!0,ut.quit())}]);Nr=kt.buildFromTemplate(Tt);Mt=["click",()=>{ye()}];Te.on("right-click",t=>{Te.popUpContextMenu(Ze)});var Nn=()=>{Te.off(...Mt),Ze=Nr},Jr=()=>{Te.on(...Mt),Ze=Vr};var Gr;Gr=t=>{var e,r,n,i,a,f,w,p;t&&(t.devToolsWebContents||({webContents:a}=t,e=new y.BrowserWindow({minimizable:!1,maximizable:!1}),[i,r]=t.getSize(),[w,p]=t.getPosition(),{width:f,height:n}=y.screen.getPrimaryDisplay().workArea,a.setDevToolsWebContents(e.webContents),a.openDevTools({mode:"detach"}),i>r?(p=0,i=0,r+=20,n-=r):(w=0,r=0,f-=i),e.setPosition(i,r),t.setPosition(w,p),e.setSize(f,n),t.focus()))};var Jn=()=>{y.globalShortcut.register("CmdOrCtrl+Alt+I",()=>Gr(y.BrowserWindow.getFocusedWindow()))},Pt,Ae,Ke,Hr,Le,Fe,de,k,Ut;({camera:Hr}=be);k=void 0;de=void 0;Pt=204;Ae=30;Fe=Le=Pt;var Zr=()=>{k&&!k.isDestroyed()&&k.getSize()[0]!==800&&(de=k.getPosition()),we(k)},Gn=t=>{var e,r;Fe=t,Le=t+Ae,r=k.getSize()[0],r!==t&&(de=k.getPosition(),e=Math.round((t-r)/2),k.setBounds({x:de[0]-e,y:de[1]-e,width:Fe,height:Le}))};Ke=!1;var Kr=()=>Ut(800,500+Ae),Hn=Ut=(t,e)=>{k&&!k.isDestroyed()||(e<=400&&(e+=Ae),Fe=t,Le=e,k=Hr({width:t,height:e,center:!0,roundedCorners:!1,resizable:!1,transparent:!0}),Ke&&Xe())},Zn=t=>{var e,r,n,i,a;k&&!k.isDestroyed()||(t=t||Pt,Ut(t,t),de?[e,r]=de:({width:a,height:n}=y.screen.getPrimaryDisplay().size,i=62+Ae+5,e=i,r=n-i-t),k.setPosition(e,r))},Kn=()=>{Zr(),Kr()},Xe=()=>{k&&!k.isDestroyed()&&(k.setAlwaysOnTop(!0,"pop-up-menu"),k.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0})),Ke=!0},Xn=()=>{k&&!k.isDestroyed()&&k.moveTop()},Xr=()=>{k&&!k.isDestroyed()&&(k.setAlwaysOnTop(!1),k.setVisibleOnAllWorkspaces(!1)),Ke=!1},Yr=function(){return k},Yn=function(){k&&!k.isDestroyed()&&k.hide()},Qn=function(){k&&!k.isDestroyed()&&(k.show(),Xe())},ei=Object.freeze(Object.defineProperty({__proto__:null,x:Zr,size:Gn,rect:Kr,default:Hn,circle:Zn,x_rect:Kn,top:Xe,top_once:Xn,untop:Xr,get_camera_win:Yr,hide:Yn,show:Qn},Symbol.toStringTag,{value:"Module"})),Bt=new Proxy({},{get:(t,e)=>()=>{var r,n,i;return{width:n,height:r}=y.screen.getPrimaryDisplay().size,i=be[e]({width:n,height:r,roundedCorners:!1,transparent:!0,resizable:!1,hasShadow:!1}),i.setAlwaysOnTop(!0,"screen-saver"),i.setPosition(0,0),i.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),i}}),pe={},At={},ti=require("./$.node");const sr=ce.default;let ct;(sr.platform()==="win32"||sr.platform()==="darwin")&&(ct=ti.getIcon);const ri=(t,e=64)=>{if(!!ct)return ct(t,e)};var ni=ri,Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});const ee=pe,ii=ce.default,it=t=>{if(!(!ee.addon||!ee.addon.getMonitorInfo))return ee.addon.getMonitorInfo(t)};class si{constructor(e){this.id=e}getBounds(){return it(this.id).bounds}getWorkArea(){return it(this.id).workArea}isPrimary(){return it(this.id).isPrimary}getScaleFactor(){if(!ee.addon||!ee.addon.getMonitorScaleFactor)return;const e=ii.release().split(".").map(r=>parseInt(r,10));return e[0]>8||e[0]===8&&e[1]>=1?ee.addon.getMonitorScaleFactor(this.id):1}isValid(){return ee.addon&&ee.addon.getMonitorInfo}}Ye.Monitor=si;var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});class ai{getBounds(){return{x:0,y:0,width:0,height:0}}getWorkArea(){return{x:0,y:0,width:0,height:0}}isPrimary(){return!1}getScaleFactor(){return 1}isValid(){return!1}}Qe.EmptyMonitor=ai;var oi=re&&re.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(At,"__esModule",{value:!0});const g=pe,li=oi(ni),fi=Ye,ui=Qe;class qe{constructor(e){if(!g.addon)return;this.id=e;const{processId:r,path:n}=g.addon.initWindow(e);this.processId=r,this.path=n}getBounds(){if(!g.addon)return;const e=g.addon.getWindowBounds(this.id);if(process.platform==="win32"){const r=this.getMonitor().getScaleFactor();e.x=Math.floor(e.x/r),e.y=Math.floor(e.y/r),e.width=Math.floor(e.width/r),e.height=Math.floor(e.height/r)}return e}setBounds(e){if(!g.addon)return;const r=Object.assign(Object.assign({},this.getBounds()),e);if(process.platform==="win32"){const n=this.getMonitor().getScaleFactor();r.x=Math.floor(r.x*n),r.y=Math.floor(r.y*n),r.width=Math.floor(r.width*n),r.height=Math.floor(r.height*n),g.addon.setWindowBounds(this.id,r)}else process.platform==="darwin"&&g.addon.setWindowBounds(this.id,r)}getTitle(){if(!!g.addon)return g.addon.getWindowTitle(this.id)}getMonitor(){return!g.addon||!g.addon.getMonitorFromWindow?new ui.EmptyMonitor:new fi.Monitor(g.addon.getMonitorFromWindow(this.id))}show(){!g.addon||!g.addon.showWindow||g.addon.showWindow(this.id,"show")}hide(){!g.addon||!g.addon.showWindow||g.addon.showWindow(this.id,"hide")}minimize(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"minimize"):process.platform==="darwin"&&g.addon.setWindowMinimized(this.id,!0))}restore(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"restore"):process.platform==="darwin"&&g.addon.setWindowMinimized(this.id,!1))}maximize(){!g.addon||(process.platform==="win32"?g.addon.showWindow(this.id,"maximize"):process.platform==="darwin"&&g.addon.setWindowMaximized(this.id))}bringToTop(){!g.addon||(process.platform==="darwin"?g.addon.bringWindowToTop(this.id,this.processId):g.addon.bringWindowToTop(this.id))}redraw(){!g.addon||!g.addon.redrawWindow||g.addon.redrawWindow(this.id)}isWindow(){if(!!g.addon){if(process.platform==="win32")return this.path&&this.path!==""&&g.addon.isWindow(this.id);if(process.platform==="darwin")return this.path&&this.path!==""&&!!g.addon.initWindow(this.id)}}isVisible(){return!g.addon||!g.addon.isWindowVisible?!0:g.addon.isWindowVisible(this.id)}toggleTransparency(e){!g.addon||!g.addon.toggleWindowTransparency||g.addon.toggleWindowTransparency(this.id,e)}setOpacity(e){!g.addon||!g.addon.setWindowOpacity||g.addon.setWindowOpacity(this.id,e)}getOpacity(){return!g.addon||!g.addon.getWindowOpacity?1:g.addon.getWindowOpacity(this.id)}getIcon(e=64){return li.default(this.path,e)}setOwner(e){if(!g.addon||!g.addon.setWindowOwner)return;let r=e;e instanceof qe?r=e.id:e||(r=0),g.addon.setWindowOwner(this.id,r)}getOwner(){if(!(!g.addon||!g.addon.getWindowOwner))return new qe(g.addon.getWindowOwner(this.id))}}At.Window=qe;var ci=require("./-.node"),di=re&&re.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(f){f(a)})}return new(r||(r=Promise))(function(a,f){function w(_){try{S(n.next(_))}catch(b){f(b)}}function p(_){try{S(n.throw(_))}catch(b){f(b)}}function S(_){_.done?a(_.value):i(_.value).then(w,p)}S((n=n.apply(t,e||[])).next())})};Object.defineProperty(pe,"__esModule",{value:!0});const Re=At;pe.Window=Re.Window;const hi=yn.default,ar=ce.default,wi=Ye,pi=Qe;let $;pe.addon=$;(ar.platform()==="win32"||ar.platform()==="darwin")&&(pe.addon=$=ci);let or=null,Ee=[];class xi extends hi.EventEmitter{constructor(){super(),this.requestAccessibility=()=>!$||!$.requestAccessibility?!0:$.requestAccessibility(),this.getActiveWindow=()=>{if(!!$)return new Re.Window($.getActiveWindow())},this.getWindows=()=>!$||!$.getWindows?[]:$.getWindows().map(r=>new Re.Window(r)).filter(r=>r.isWindow()),this.getMonitors=()=>!$||!$.getMonitors?[]:$.getMonitors().map(r=>new wi.Monitor(r)),this.getPrimaryMonitor=()=>process.platform==="win32"?this.getMonitors().find(r=>r.isPrimary):new pi.EmptyMonitor,this.createProcess=(r,n="")=>{if(!(!$||!$.createProcess))return $.createProcess(r,n)};let e;!$||(this.on("newListener",r=>{if(r==="window-activated"&&(e=$.getActiveWindow()),Ee.indexOf(r)===-1){if(r==="window-activated")or=setInterval(()=>di(this,void 0,void 0,function*(){const n=$.getActiveWindow();e!==n&&(e=n,this.emit("window-activated",new Re.Window(n)))}),50);else return;Ee.push(r)}}),this.on("removeListener",r=>{this.listenerCount(r)>0||(r==="window-activated"&&clearInterval(or),Ee=Ee.filter(n=>n!==r))}))}}const gi=new xi;var Qr=pe.windowManager=gi,It,ie,dt,Wt,en,tn,rn,nn,sn,A;({recbar:sn}=be);A=void 0;ie=void 0;({draw:nn}=Bt);var yi=()=>{ie||(ie=nn(),ie.on("close",()=>ie=void 0),an())},an=()=>{ve(),ie.focus()},mi=()=>{we(ie),ie=void 0};dt=["CommandOrControl+R","CommandOrControl+W","CommandOrControl+Q","Alt+F4","F5"];It={"browser-window-focus":()=>{var t;for(t of dt)y.globalShortcut.register(t,()=>{})},"browser-window-blur":()=>{var t;for(t of dt)y.globalShortcut.unregister(t,()=>{})}};var Et=t=>{var e;return t==="camera"?e=500:e=696+30,en(e)};en=t=>{var e,r,n,i,a,f,w,p;a=Object.entries(It);for(p of a)[n,e]=p,y.app.on(n,e);return Nn(),r=48+40,i={roundedCorners:!1,transparent:!0,resizable:!1,width:t,height:r},A=sn(i),A.on("close",()=>A=void 0),{width:w,height:f}=y.screen.getPrimaryDisplay().workArea,A.setBounds({x:Math.round((w-t)/2),y:f-28-r,width:t,height:r}),ve(),Xe(),A.hookWindowMessage(278,()=>(A.setEnabled(!1),setTimeout(()=>A.setEnabled(!0),100),!0)),new Promise(S=>A.webContents.on("did-finish-load",()=>{ve(),A.focus(),S(A)}))};var ve=()=>{A&&(A.setAlwaysOnTop(!0,"screen-saver"),A.moveTop())};tn=async function(){var t,e,r,n,i,a,f;return{width:f,height:a}=y.screen.getPrimaryDisplay().workArea,t=[0,0,f,a],n=await A.webContents.executeJavaScript("localStorage",!0),i=JSON.parse(n.record),i.src==="camera"?(r=Yr(),e=r.getBounds(),t=[e.x,e.y,e.width,e.height]):i.area!==0&&n.area&&(t=JSON.parse(n.area),t.length!==4&&(t=void 0)),t||(t=[0,0,f,a]),t};var vi=()=>{var t,e,r,n,i,a,f,w,p;n=A.getPosition(),[r,e]=A.getSize(),[p,t]=A.size,t=48+40,{width:w,height:f}=y.screen.getPrimaryDisplay().bounds,i=n[0]+Math.round((r-p)/2),i<0&&(i=0),i>w-p&&(i=w-p),a=n[1]-(48-32),a<0&&(a=0),a>f-t&&(a=f-t),A.setBounds({x:i,y:a,width:p,height:t}),ve()},bi=async()=>{var t,e,r,n,i,a,f,w;[f,w,i,t]=await tn(),A.getPosition(),A.size=A.getSize(),a=88,e=32,{width:n,height:r}=y.screen.getPrimaryDisplay().bounds,w>60?w=w-e-5:w=0,f=f+Math.round((i-a)/2),f<0&&(f=0),f>n-a&&(f=n-a),A.setBounds({x:f,y:w,width:a,height:e}),A.moveTop()};Wt=()=>{var t,e,r,n;r=Object.entries(It);for(n of r)[e,t]=n,y.app.off(e,t);Jr(),Xr()};var Si=()=>{Wt(),Ve("show")},_i=()=>{Wt(),Ve()},Oi=()=>{A.hide()};rn=(...t)=>y.desktopCapturer.getSources({types:t,thumbnailSize:{width:0,height:0}});var ki=async()=>{var t,e;e=await rn("screen");for(t of e)return t.id},Mi=async()=>{var t,e,r,n,i,a,f,w,p,S,_,b,U,P,j;({bounds:t}=y.screen.getPrimaryDisplay()),{scaleFactor:_}=y.screen.getPrimaryDisplay(),a=new Map,p=await y.desktopCapturer.getSources({types:["window"],fetchWindowIcons:!1,thumbnailSize:{width:320*_,height:180*_}});for(n of p)a.set(Math.floor(n.id.split(":")[1]),[n.thumbnail.toDataURL(),n.name]);w=[],S=Qr.getWindows();for(n of S)if({id:i}=n,!process.execPath.startsWith(n.path)&&(f=a.get(i),f)){if({x:P,y:j,width:U,height:r}=n.getBounds(),P+U<=0&&P<=0||P+U>t.width&&P>t.width||j+r<=0&&j<=0||j+r>t.height&&j>t.height)continue;b=t.width-P,U>b&&(U=b),e=t.height-j,r>e&&(r=e),P<0&&(P=0),j<0&&(j=0),w.push(f.concat([i,P,j,U,r]))}return w},Ti=t=>{y.BrowserWindow.getAllWindows().forEach(e=>{var r;if({hash:r}=new URL(e.webContents.getURL()),!t&&r.slice(1)==="camera"){we(e);return}return e.hide()})},Pi=Object.freeze(Object.defineProperty({__proto__:null,draw:yi,draw_top:an,draw_x:mi,工具条:Et,top:ve,expand:vi,fold:bi,cancel:Si,end:_i,hide:Oi,screen_source:ki,win_source:Mi,stop:Ti},Symbol.toStringTag,{value:"Module"})),on,F;({count_down:on}=be);F=void 0;var ln=()=>{var t;if(F){F.focus();return}t=240,F=on({width:t,height:t,transparent:!0,resizable:!1,hasShadow:!1}),F.on("close",()=>{F=void 0}),F.setAlwaysOnTop(!0,"screen-saver"),F.on("show",()=>{var e,r,n,i;i=y.BrowserWindow.getAllWindows();for(r of i)r.webContents.getURL().endsWith("/#main")||r.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0});n=setInterval(()=>F?F.moveTop():e(),300),e=()=>{clearInterval(n)},F.on("hide",e),F.on("close",e)})},Ui={hide:()=>{F!=null&&F.hide()},close:()=>{F!=null&&F.close(),ve()}},Bi=typeof re=="object"&&re&&re.Object===Object&&re,Ai=Bi,Ii=Ai,Wi=typeof self=="object"&&self&&self.Object===Object&&self,Ei=Ii||Wi||Function("return this")(),ji=Ei,Di=ji,Ri=Di.Symbol,jt=Ri,lr=jt;lr&&lr.toStringTag;var fr=jt;fr&&fr.toStringTag;var ur=jt,cr=ur?ur.prototype:void 0;cr&&cr.toString;var $i=async t=>{};var Pe,Dt,Rt,$t,Ct;Pe=Rt=Dt=void 0;$t=()=>{Dt=new Promise(t=>{Rt=t})};$t();Ct=t=>{Pe.once("closed",()=>{Rt(t),$t()}),we(Pe)};var Ci=()=>{Ct(!0)},zi=()=>{Ct(!1)},Li=t=>(Pe=Bt["confirm_"+t]({width:275,height:190,modal:!0,isAlwaysOnTop:!0,visibleOnAllWorkspaces:!0}),Pe.setAlwaysOnTop(!0,"screen-saver"),Dt),Fi=Object.freeze(Object.defineProperty({__proto__:null,y:Ci,n:zi,show:Li},Symbol.toStringTag,{value:"Module"})),qi=t=>{var e;if(e=y.app.getLoginItemSettings().openAtLogin,e!==t)return y.app.setLoginItemSettings({openAtLogin:t})},Vi=Object.freeze(Object.defineProperty({__proto__:null,auto_start:qi},Symbol.toStringTag,{value:"Module"})),Ni=t=>{mr.ID=t},Ji=Object.freeze(Object.defineProperty({__proto__:null,ID:Ni},Symbol.toStringTag,{value:"Module"})),Gi=function(){var t,e,r;return r=this.sender.getOwnerBrowserWindow(),e=r.getBounds(),t=n=>{var i,a;if(a=r[n],i=e[n],a&&i>a&&i-a<3){e[n]=a;return}r[n]=i},["height","width"].map(t),e},Hi=function(t,e,r,n){var i,a;a=this.sender.getOwnerBrowserWindow();try{a.setBounds({x:Math.round(t),y:Math.round(e),width:r,height:n})}catch(f){i=f,console.error(JSON.stringify([t,e,r,n]),i)}},Zi=Object.freeze(Object.defineProperty({__proto__:null,getBounds:Gi,setBounds:Hi},Symbol.toStringTag,{value:"Module"}));var fn,zt,Lt,he,un;({area:fn,win_area:un}=Bt);he=void 0;var Ki=t=>{var e,r,n;r=void 0,n=Qr.getWindows();for(e of n)if(t===e.id){r=e;break}r&&(he.setAlwaysOnTop(!1),r.bringToTop(),Lt())};Lt=()=>{he.setAlwaysOnTop(!0,"screen-saver")};zt=t=>{he=t(),Lt(),he.on("close",()=>he=void 0)};var Xi=()=>zt(un),Yi=()=>zt(fn),Qi=()=>{Et(),he.setIgnoreMouseEvents(!0,{forward:!0}),ln()},es=()=>{var t,e;return{x:t,y:e}=y.screen.getCursorScreenPoint(),[t,e]};function ts(t,e,r,n){var i;if(i=t==="camera",!i&&n){[Xi,Yi][n-1]();return}else ln();Et(t)}var rs=(t,e,r,n)=>{Ve(),ts(t,e,r,n)},ns=t=>{y.shell.openExternal(t)},is=()=>hr.ROOT,ss=Object.freeze(Object.defineProperty({__proto__:null,userData:is,close:Ve,x:gr,count_down:Ui,permission:$i,confirm:Fi,auto_update:qn,auto_start:Vi,recbar:Pi,USER:Ji,camera:ei,drag:Zi,area:Qi,wintop:Ki,main:ye,mouse:es,rec:rs,open:ns},Symbol.toStringTag,{value:"Module"}));process.on("exit",()=>{y.app.quit()});y.app.requestSingleInstanceLock()||(y.app.quit(),process.exit(0));(async()=>{var t;t=await Promise.resolve().then(function(){return require("./g.js")}),t.init({dsn:"https://54c0fbe278e049c8a9635fc0fa612836@sentry.dalukuankuan.com/6",attachStacktrace:!0})})();y.app.commandLine.appendSwitch("webrtc-max-cpu-consumption-percentage","100");y.app.commandLine.appendSwitch("js-flags","--expose_gc --max-old-space-size=512");(()=>{var t,e,r,n,i;ye(),t=(a,f)=>{var w,p,S,_;f instanceof Function&&y.ipcMain.handle(a.join("."),(b,U)=>f.apply(b,U)),S=Object.entries(f);for(_ of S)[p,w]=_,t([...a,p],w)},r=Object.entries(ss);for(i of r)[e,n]=i,t([e],n);Jr(),Jn()})();vn(y.app,{"second-instance":ye,activate:ye});
