import k from"./5.js";import{c as r}from"./z.js";import{b as g,g as S,m as v}from"./1.js";import{v as y}from"./t.js";import{i as w}from"./2.js";import{k as b,J as h}from"./g.js";import"./0.js";import"./-.js";import"./b.js";import"./n.js";import"./$0.js";import"./..js";import"./r.js";import"./e.js";function M(){return new Worker("/k.js",{type:"module"})}var p,t,i,d,n,s,f,l,u,c,_,e;({camera:d}=w);try{l=await y(),e=l.getVideoTracks()[0],{area:p}=r,p&&(_=new MediaStreamTrackProcessor({track:e,maxBufferSize:15}),e=new MediaStreamTrackGenerator({kind:"video"}),s=[_.readable,e.writable],f=()=>{new M().postMessage([localStorage.ppi-0,...s,...JSON.parse(localStorage.area)],s)}),e.contentHint="detail",t=await g(),i=t?t.getTracks():[],c=await S(r.sys_audio),u=new MediaStream([e,...v(i,c)]),b(()=>{var a,o,m;a=!!r.audio;for(o of i)o.enabled=a;m=r.sys_audio;for(o of c)o.enabled=m}),h(()=>r.video,async()=>{var a;({video:a}=r),a?await d.show(localStorage.face_area_size-0):await d.hide()}),k(u,i,f)}catch(a){n=a,console.error("capture desktop failed:",n),w.recbar.send_quick_stop()}
