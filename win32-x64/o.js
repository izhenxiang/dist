import{c as s,m as y}from"./e.js";import{r as x,I as w,k as g,a as S,m as b,n as j,d as z,_ as A}from"./i.js";import{H as B}from"./q.js";import{i as _}from"./4.js";var U={setup:()=>{var a,e,r,t;return t=x(0),r=void 0,e=void 0,a=()=>{e&&(clearInterval(r),e(),e=void 0)},w(a),g(async()=>{var o,n,c,l,u,d,f;a(),{audio:c}=s,c&&(f=await y.audio(c),o=new AudioContext,d=o.createMediaStreamSource(f),n=o.createAnalyser(),n.minDecibels=-90,n.maxDecibels=-10,n.fftSize=32,e=()=>(d.disconnect(n),o.close()),l=n.frequencyBinCount,u=new Uint8Array(l),r=setInterval(()=>{n.getByteFrequencyData(u),t.value=Math.round(Math.min(1,Math.max(...u)/200)*100)},100),d.connect(n))}),{vol:t,config:s}}};function k(a,e){return z(),S("a",{class:b(["audio",{x:!a.config.audio}]),title:"麦克风",style:j("--vol:"+a.vol+"%")},null,6)}var D=A(U,[["render",k],["__scopeId","data-v-29e43359"]]);var v,m;m=()=>{var a;return a=new Headers,a.append("user_token",localStorage.uid),a};v=class{constructor(e){this.json=this.json.bind(this),this.ipc=e}async fetch(e,r={}){var t;if(r.headers=m(),e.indexOf(".do")<0&&(e+=".do"),t=await fetch(B+e,r),t.status===401){delete localStorage.uid,this.ipc.auto_update.relaunch();return}return t}async json(e,r={}){var t;return t=await this.fetch(e,r),t.json()}};var h=a=>new v(a);var i,p,q=h(_);p=h(_);i=5*60;var E=async function(){var a,e;try{({space:{max:e}}=await s.json("user/get"))}catch(r){a=r,console.error(a),e=500*1024*1024}e>=1e3*1024*1024*1024?(s.duration_txt="单次最长录制5小时",s.max_duration=5*60*60+i):e>=10*1024*1024*1024?(s.duration_txt='单次最长录制3小时, "扩容"可获更长时间',s.max_duration=3*60*60+i):(s.duration_txt='单次最长录制30分钟, "扩容"可获更长时间',s.max_duration=30*60+i)};export{E as f,q as u,D as z};
