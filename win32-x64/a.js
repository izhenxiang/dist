import{c as o}from"./r.js";import{m as y}from"./9.js";import{r as x,I as w,k as g,a as S,m as b,n as j,d as z,_ as A}from"./c.js";import{H as B}from"./j.js";import{i as _}from"./3.js";var U={setup:()=>{var a,e,r,t;return t=x(0),r=void 0,e=void 0,a=()=>{e&&(clearInterval(r),e(),e=void 0)},w(a),g(async()=>{var s,n,c,l,u,d,f;a(),{audio:c}=o,c&&(f=await y.audio(c),s=new AudioContext,d=s.createMediaStreamSource(f),n=s.createAnalyser(),n.minDecibels=-90,n.maxDecibels=-10,n.fftSize=32,e=()=>(d.disconnect(n),s.close()),l=n.frequencyBinCount,u=new Uint8Array(l),r=setInterval(()=>{n.getByteFrequencyData(u),t.value=Math.round(Math.min(1,Math.max(...u)/200)*100)},100),d.connect(n))}),{vol:t,config:o}}};function k(a,e){return z(),S("a",{class:b(["audio",{x:!a.config.audio}]),title:"麦克风",style:j("--vol:"+a.vol+"%")},null,6)}var H=A(U,[["render",k],["__scopeId","data-v-29e43359"]]);var m,v;v=()=>{var a;return a=new Headers,a.append("user_token",localStorage.uid),a};m=class{constructor(e){this.json=this.json.bind(this),this.ipc=e}async fetch(e,r={}){var t;if(r.headers=v(),e.indexOf(".do")<0&&(e+=".do"),t=await fetch(B+e,r),t.status===401){delete localStorage.uid,this.ipc.auto_update.relaunch();return}return t}async json(e,r={}){var t;return t=await this.fetch(e,r),t.json()}};var h=a=>new m(a);var i,p,E=h(_);p=h(_);i=1*60;var T=async function(){var a,e;try{({space:{max:e}}=await o.json("user/get"))}catch(r){a=r,console.error(a),e=500*1024*1024}e>=1e3*1024*1024*1024?(o.duration_txt="单次最长录制5小时",o.max_duration=5*60*60+i):e>=10*1024*1024*1024?(o.duration_txt='单次最长录制3小时, "扩容"可获更长时间',o.max_duration=3*60*60+i):(o.duration_txt='单次最长录制30分钟, "扩容"可获更长时间',o.max_duration=30*60+i)};export{T as f,E as u,H as z};
