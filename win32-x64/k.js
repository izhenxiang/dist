var R=Object.defineProperty;var D=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var A=(e,o,r)=>o in e?R(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,B=(e,o)=>{for(var r in o||(o={}))q.call(o,r)&&A(e,r,o[r]);if(D)for(var r of D(o))Q.call(o,r)&&A(e,r,o[r]);return e};import{c as n}from"./-.js";import{i as y}from"./3.js";import{H as E,o as W,d,a as l,F as m,Q as S,m as H,e as s,t as g,p as k,i as I,_ as b,x as G,L as C,R as V,s as j,k as J,b as v,f as p,c as K,w as T,j as X,h as Y}from"./a.js";import{z as Z}from"./$..js";import{b as ee}from"./9.js";import{s as oe}from"./d.js";import"./2.js";import{H as L}from"./$.js";import"./7.js";import"./1.js";import"./0.js";import"./g.js";var f,N,h;({camera:f,main:N}=y);h=()=>{var e,o;if(gc(),document.hidden){localStorage.recing||f.x();return}switch(delete localStorage.recing,{src:e}=n,f.x(),e){case"screen":n.video="";break;default:if(!n.video){if({video:o}=localStorage,!o)return;n.video=o}e==="all"?f.circle(localStorage.人像尺寸-0):f.rect(),setTimeout(()=>{document.hidden||N(!1)},1e3)}};document.addEventListener("visibilitychange",h);var te={setup:()=>{var e,o,r,t,a,i;for(t=["all 屏幕+摄像头录制","screen 屏幕录制","camera 摄像头录制"],i=o=0,r=t.length;o<r;i=++o)e=t[i],a=e.indexOf(" "),t[i]=[e.slice(0,a),e.slice(1+a)];return E(()=>n.src,h),W(h),E(()=>n.video,c=>{var u;document.hidden||({src:u}=n,c?u==="screen"&&(n.src=localStorage.src||"all"):u!=="screen"&&(localStorage.src=n.src,n.src="screen"),h())}),{li:t,config:n,go:c=>{n.src=c}}}};const re=e=>(k("data-v-1eb91dd6"),e=e(),I(),e),ae={class:"method"},se=["onClick"],ne=re(()=>s("b",{class:"ico"},null,-1));function ie(e,o){return d(),l("div",ae,[(d(!0),l(m,null,S(e.li,([r,t])=>(d(),l("a",{class:H([r,e.config.src==r?"now":""]),onClick:a=>e.go(r)},[ne,s("i",null,g(t),1)],10,se))),256))])}var de=b(te,[["render",ie],["__scopeId","data-v-1eb91dd6"]]),le={setup:()=>({config:n,disabled:G(()=>n.src==="camera"),li:"整个桌面 应用窗口 指定区域".split(" ")})};const ce=e=>(k("data-v-cf47a3ec"),e=e(),I(),e),ue={class:"bk"},_e=ce(()=>s("h2",null,"录制区域",-1)),ve={class:"select"},pe=["disabled"],fe=["value"];function he(e,o){return d(),l("div",ue,[_e,s("div",ve,[C(s("select",{disabled:e.disabled,"onUpdate:modelValue":o[0]||(o[0]=r=>e.config.area=r)},[(d(!0),l(m,null,S(e.li,(r,t)=>(d(),l("option",{value:t},g(r),9,fe))),256))],8,pe),[[V,e.config.area]])])])}var me=b(le,[["render",he],["__scopeId","data-v-cf47a3ec"]]),ge={components:{zAudio:Z},setup:()=>{var e,o,r;return r={audio:j([]),video:j([])},{mediaDevices:e}=navigator,o=async()=>{var t,a,i,c,u,$,F,_,w,U,z;$={},F=await e.enumerateDevices();for(U of F)({kind:c,label:u,deviceId:t}=U),t==="default"&&(u=u.replace("Default - ","默认 ")),c.endsWith("input")&&(c=c.slice(0,-5),($[c]=$[c]||[]).push([t,u]));for(i in r)r[i].value=$[i]||[];for(i in r){if({value:w}=r[i],w.length){if(_=n[i],_){for(z of w)if([a]=z,_===a)return}_!==""&&(_=w[0][0])}else _=0;n[i]=_}},J(()=>{var t,a,i;a=["audio","video"];for(t of a)i=n[t],i&&(localStorage[t]=i)}),(async()=>await o())(),B({refresh:o,config:n,x:t=>{var a;a=n[t],a?a="":a=localStorage[t]||"",n[t]=a}},r)}};const x=e=>(k("data-v-91eb65b6"),e=e(),I(),e),be={class:"bk"},$e=x(()=>s("h2",null,"设备设置",-1)),we={class:"video"},Se={class:"select"},ye={label:"输入源"},ke=["value"],Ie=x(()=>s("optgroup",{label:"───"},[s("option",{value:""},"禁用")],-1)),Ce={class:"audio"},Ve={class:"select"},je={label:"输入源"},xe=["value"],Fe=x(()=>s("optgroup",{label:"───"},[s("option",{value:""},"禁用")],-1));function Ue(e,o){const r=v("z-audio");return d(),l("div",be,[$e,s("li",we,[s("label",{class:H({x:!e.config.video}),onClick:o[0]||(o[0]=t=>e.x("video")),for:"driveVideo"},null,2),s("div",Se,[C(s("select",{id:"driveVideo",onFocus:o[1]||(o[1]=(...t)=>e.refresh&&e.refresh(...t)),"onUpdate:modelValue":o[2]||(o[2]=t=>e.config.video=t)},[s("optgroup",ye,[(d(!0),l(m,null,S(e.video,([t,a])=>(d(),l("option",{value:t},g(a),9,ke))),256))]),Ie],544),[[V,e.config.video]])])]),s("li",Ce,[s("label",{onClick:o[3]||(o[3]=t=>e.x("audio")),for:"driveAudio"},[p(r)]),s("div",Ve,[C(s("select",{id:"driveAudio",onFocus:o[4]||(o[4]=(...t)=>e.refresh&&e.refresh(...t)),"onUpdate:modelValue":o[5]||(o[5]=t=>e.config.audio=t)},[s("optgroup",je,[(d(!0),l(m,null,S(e.audio,([t,a])=>(d(),l("option",{value:t},g(a),9,xe))),256))]),Fe],544),[[V,e.config.audio]])])])])}var ze=b(ge,[["render",Ue],["__scopeId","data-v-91eb65b6"]]),De={components:{btn:ee}};const Ae=e=>(k("data-v-b0e482fa"),e=e(),I(),e),Be=Ae(()=>s("b",null,null,-1));function Ee(e,o){const r=v("btn");return d(),K(r,null,{default:T(()=>[Be,X(e.$slots,"default",{},void 0,!0)]),_:3})}var He=b(De,[["render",Ee],["__scopeId","data-v-b0e482fa"]]);var M,O;O=()=>{var e;return e=new Headers,e.append("user_token",localStorage.uid),e};M=class{constructor(o){this.json=this.json.bind(this),this.ipc=o}async fetch(o,r={}){var t;if(r.headers=O(),o.indexOf(".do")<0&&(o+=".do"),t=await fetch(L+o,r),t.status===401){delete localStorage.uid,this.ipc.auto_update.relaunch();return}return t}async json(o,r={}){var t;return t=await this.fetch(o,r),t.json()}};var Te=e=>new M(e);var Le=Te(y),Ne=new Proxy(()=>{},{get:(e,o)=>{_paq.push(["trackEvent","点",o])}}),P;({auto_update:P}=y);var Me={components:{src:de,rArea:me,drive:ze,btn:He},setup:()=>{var e,o;return o="开始录制",e=j(o),{txt:e,start:async()=>{var r,t,a;localStorage.recing=1,{avatarUrl:r,space:{used:a,max:t}}=await Le.json("user/get"),localStorage.ico=r,a>=t?(e.value="请付费扩容后点此录制",y.open(L+"?pay=true&user_token="+localStorage.uid)):(e.value=o,Ne.录,oe())}}}};(async()=>await P.update_promise())();function Oe(e,o){const r=v("src"),t=v("r-area"),a=v("drive"),i=v("btn");return d(),l(m,null,[p(r),s("main",null,[p(t),p(a),p(i,{onClick:e.start},{default:T(()=>[Y(g(e.txt),1)]),_:1},8,["onClick"])])],64)}var ro=b(Me,[["render",Oe],["__scopeId","data-v-398c0d36"]]);export{ro as default};
