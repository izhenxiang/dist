"use strict";var Bn=Object.defineProperty;var Vr=Object.getOwnPropertySymbols;var Dn=Object.prototype.hasOwnProperty,zn=Object.prototype.propertyIsEnumerable;var Nr=(e,r,t)=>r in e?Bn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,qr=(e,r)=>{for(var t in r||(r={}))Dn.call(r,t)&&Nr(e,t,r[t]);if(Vr)for(var t of Vr(r))zn.call(r,t)&&Nr(e,t,r[t]);return e};var S=require("electron"),Ln=require("os"),re=require("fs"),H=require("path"),Fn=require("crypto"),wt=require("zlib"),Vn=require("util"),ae=require("./k.js"),Oe=require("fs/promises"),Be=require("./w.js"),yt=require("./x.js"),Nn=require("events");function bt(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Fe=bt(Ln),qn=bt(Nn),te=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Zn(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var Hn="darwin",xe=e=>{if(!!e&&!e.isDestroyed()){e.close();try{e.destroy()}catch{}}},Jn=(e,r)=>{var t,n;for(t in r)n=r[t],e.on(t,n);return e};pr=hr=xr=__dirname;var xr=xr,hr=hr,pr=pr,er,vt;er="127.0.0.1",vt="http://"+er,S.session.defaultSession.protocol.interceptStreamProtocol("http",(e,r)=>{var t,n,i,o,f,p,g,m,_;if(_=new URL(e.url),_.host===er)({pathname:f}=_),f==="/"&&(f+=".htm"),m=f.slice(f.lastIndexOf(".")+1),m.startsWith("htm")?o="text/html":o={js:"text/javascript",css:"text/css",svg:"image/svg+xml",woff2:"font/woff2"}[m]||"application/octet-stream",n=re.createReadStream(hr+f),r({data:n,statusCode:200,headers:{"content-type":o}});else{if(e.useSessionCookies=!0,e.partition="persist:I",p=S.net.request(e),p.on("response",b=>{var M,T;({headers:M,statusCode:T}=b),r({data:b},M,T)}),e.uploadData){g=e.uploadData;for(i of g)({bytes:t}=i),t&&p.write(t)}p.end()}});var ve=new Proxy({},{get:(e,r)=>t=>{var n;return t=qr({skipTaskbar:!0,frame:!1,minimizable:!1,maximizable:!1,fullscreenable:!1,type:"toolbar",shadow:!1,hasShadow:!1,transparent:!0,webPreferences:{preload:H.join(xr,"s.js"),webSecurity:!1}},t),n=new S.BrowserWindow(t),n.setMenu(null),r!=="main"&&n.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),n.loadURL(vt+"#"+r),n.once("ready-to-show",()=>{n.show()}),n.focus(),n}}),mt;({main:mt}=ve);var ye=(e=!0)=>{var r,t,n,i;if(t=S.BrowserWindow.getAllWindows(),t.length)for(r of t)switch(n=r.webContents.getURL().split("/#").pop(),n){case"main":i=r;break;case"recbar":case"win_area":case"area":return}i?(i.isMinimized(),i.restore()):i=mt({type:"",resizable:!1,height:590,width:426,skipTaskbar:!1}),!(!e&&!i.isVisible())&&(i.show(),i.moveTop(),i.focus())},St={ID:""},Gn="x64",ir;try{ir=new TextDecoder}catch{}var x,se,s=0,V={},A,ne,Z=0,K=0,L,Q,N=[],k,Zr={useRecords:!1,mapsAsObjects:!0};class _t{}const Ot=new _t;Ot.name="MessagePack 0xC1";var be=!1,Tt=2;try{new Function("")}catch{Tt=1/0}class Te{constructor(r){r&&(r.useRecords===!1&&r.mapsAsObjects===void 0&&(r.mapsAsObjects=!0),r.structures?r.structures.sharedLength=r.structures.length:r.getStructures&&((r.structures=[]).uninitialized=!0,r.structures.sharedLength=0)),Object.assign(this,r)}unpack(r,t){if(x)return jt(()=>(ar(),this?this.unpack(r,t):Te.prototype.unpack.call(Zr,r,t)));se=t>-1?t:r.length,s=0,K=0,ne=null,L=null,x=r;try{k=r.dataView||(r.dataView=new DataView(r.buffer,r.byteOffset,r.byteLength))}catch(n){throw x=null,r instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(r&&typeof r=="object"?r.constructor.name:typeof r))}if(this instanceof Te){if(V=this,this.structures)return A=this.structures,Re();(!A||A.length>0)&&(A=[])}else V=Zr,(!A||A.length>0)&&(A=[]);return Re()}unpackMultiple(r,t){let n,i=0;try{be=!0;let o=r.length,f=this?this.unpack(r,o):Ve.unpack(r,o);if(t){for(t(f);s<o;)if(i=s,t(Re())===!1)return}else{for(n=[f];s<o;)i=s,n.push(Re());return n}}catch(o){throw o.lastPosition=i,o.values=n,o}finally{be=!1,ar()}}_mergeStructures(r,t){r=r||[];for(let n=0,i=r.length;n<i;n++){let o=r[n];o&&(o.isShared=!0,n>=32&&(o.highByte=n-32>>5))}r.sharedLength=r.length;for(let n in t||[])if(n>=0){let i=r[n],o=t[n];o&&(i&&((r.restoreStructures||(r.restoreStructures=[]))[n]=i),r[n]=o)}return this.structures=r}decode(r,t){return this.unpack(r,t)}}function Re(){try{if(!V.trusted&&!be){let r=A.sharedLength||0;r<A.length&&(A.length=r)}let e=C();if(L&&(s=L.postBundlePosition),s==se)A.restoreStructures&&Hr(),A=null,x=null,Q&&(Q=null);else if(s>se){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}else if(!be)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw A.restoreStructures&&Hr(),ar(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function Hr(){for(let e in A.restoreStructures)A[e]=A.restoreStructures[e];A.restoreStructures=null}function C(){let e=x[s++];if(e<160)if(e<128){if(e<64)return e;{let r=A[e&63]||V.getStructures&&kt()[e&63];return r?(r.read||(r.read=gr(r,e&63)),r.read()):e}}else if(e<144)if(e-=128,V.mapsAsObjects){let r={};for(let t=0;t<e;t++)r[Mt()]=C();return r}else{let r=new Map;for(let t=0;t<e;t++)r.set(C(),C());return r}else{e-=144;let r=new Array(e);for(let t=0;t<e;t++)r[t]=C();return r}else if(e<192){let r=e-160;if(K>=s)return ne.slice(s-Z,(s+=r)-Z);if(K==0&&se<140){let t=r<16?wr(r):At(r);if(t!=null)return t}return sr(r)}else{let r;switch(e){case 192:return null;case 193:return L?(r=C(),r>0?L[1].slice(L.position1,L.position1+=r):L[0].slice(L.position0,L.position0-=r)):Ot;case 194:return!1;case 195:return!0;case 196:return rr(x[s++]);case 197:return r=k.getUint16(s),s+=2,rr(r);case 198:return r=k.getUint32(s),s+=4,rr(r);case 199:return le(x[s++]);case 200:return r=k.getUint16(s),s+=2,le(r);case 201:return r=k.getUint32(s),s+=4,le(r);case 202:if(r=k.getFloat32(s),V.useFloat32>2){let t=yr[(x[s]&127)<<1|x[s+1]>>7];return s+=4,(t*r+(r>0?.5:-.5)>>0)/t}return s+=4,r;case 203:return r=k.getFloat64(s),s+=8,r;case 204:return x[s++];case 205:return r=k.getUint16(s),s+=2,r;case 206:return r=k.getUint32(s),s+=4,r;case 207:return V.int64AsNumber?(r=k.getUint32(s)*4294967296,r+=k.getUint32(s+4)):r=k.getBigUint64(s),s+=8,r;case 208:return k.getInt8(s++);case 209:return r=k.getInt16(s),s+=2,r;case 210:return r=k.getInt32(s),s+=4,r;case 211:return V.int64AsNumber?(r=k.getInt32(s)*4294967296,r+=k.getUint32(s+4)):r=k.getBigInt64(s),s+=8,r;case 212:if(r=x[s++],r==114)return Qr(x[s++]&63);{let t=N[r];if(t)return t.read?(s++,t.read(C())):t.noBuffer?(s++,t()):t(x.subarray(s,++s));throw new Error("Unknown extension "+r)}case 213:return r=x[s],r==114?(s++,Qr(x[s++]&63,x[s++])):le(2);case 214:return le(4);case 215:return le(8);case 216:return le(16);case 217:return r=x[s++],K>=s?ne.slice(s-Z,(s+=r)-Z):Kn(r);case 218:return r=k.getUint16(s),s+=2,K>=s?ne.slice(s-Z,(s+=r)-Z):Xn(r);case 219:return r=k.getUint32(s),s+=4,K>=s?ne.slice(s-Z,(s+=r)-Z):Qn(r);case 220:return r=k.getUint16(s),s+=2,Gr(r);case 221:return r=k.getUint32(s),s+=4,Gr(r);case 222:return r=k.getUint16(s),s+=2,Yr(r);case 223:return r=k.getUint32(s),s+=4,Yr(r);default:if(e>=224)return e-256;if(e===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+e)}}}const Yn=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function gr(e,r){function t(){if(t.count++>Tt){let i=e.read=new Function("r","return function(){return {"+e.map(o=>Yn.test(o)?o+":r()":"["+JSON.stringify(o)+"]:r()").join(",")+"}}")(C);return e.highByte===0&&(e.read=Jr(r,e.read)),i()}let n={};for(let i=0,o=e.length;i<o;i++){let f=e[i];n[f]=C()}return n}return t.count=0,e.highByte===0?Jr(r,t):t}const Jr=(e,r)=>function(){let t=x[s++];if(t===0)return r();let n=e<32?-(e+(t<<5)):e+(t<<5),i=A[n]||kt()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=gr(i,e)),i.read()};function kt(){let e=jt(()=>(x=null,V.getStructures()));return A=V._mergeStructures(e,A)}var sr=$e,Kn=$e,Xn=$e,Qn=$e;function $e(e){let r;if(e<16&&(r=wr(e)))return r;if(e>64&&ir)return ir.decode(x.subarray(s,s+=e));const t=s+e,n=[];for(r="";s<t;){const i=x[s++];if((i&128)===0)n.push(i);else if((i&224)===192){const o=x[s++]&63;n.push((i&31)<<6|o)}else if((i&240)===224){const o=x[s++]&63,f=x[s++]&63;n.push((i&31)<<12|o<<6|f)}else if((i&248)===240){const o=x[s++]&63,f=x[s++]&63,p=x[s++]&63;let g=(i&7)<<18|o<<12|f<<6|p;g>65535&&(g-=65536,n.push(g>>>10&1023|55296),g=56320|g&1023),n.push(g)}else n.push(i);n.length>=4096&&(r+=D.apply(String,n),n.length=0)}return n.length>0&&(r+=D.apply(String,n)),r}function Gr(e){let r=new Array(e);for(let t=0;t<e;t++)r[t]=C();return r}function Yr(e){if(V.mapsAsObjects){let r={};for(let t=0;t<e;t++)r[Mt()]=C();return r}else{let r=new Map;for(let t=0;t<e;t++)r.set(C(),C());return r}}var D=String.fromCharCode;function At(e){let r=s,t=new Array(e);for(let n=0;n<e;n++){const i=x[s++];if((i&128)>0){s=r;return}t[n]=i}return D.apply(String,t)}function wr(e){if(e<4)if(e<2){if(e===0)return"";{let r=x[s++];if((r&128)>1){s-=1;return}return D(r)}}else{let r=x[s++],t=x[s++];if((r&128)>0||(t&128)>0){s-=2;return}if(e<3)return D(r,t);let n=x[s++];if((n&128)>0){s-=3;return}return D(r,t,n)}else{let r=x[s++],t=x[s++],n=x[s++],i=x[s++];if((r&128)>0||(t&128)>0||(n&128)>0||(i&128)>0){s-=4;return}if(e<6){if(e===4)return D(r,t,n,i);{let o=x[s++];if((o&128)>0){s-=5;return}return D(r,t,n,i,o)}}else if(e<8){let o=x[s++],f=x[s++];if((o&128)>0||(f&128)>0){s-=6;return}if(e<7)return D(r,t,n,i,o,f);let p=x[s++];if((p&128)>0){s-=7;return}return D(r,t,n,i,o,f,p)}else{let o=x[s++],f=x[s++],p=x[s++],g=x[s++];if((o&128)>0||(f&128)>0||(p&128)>0||(g&128)>0){s-=8;return}if(e<10){if(e===8)return D(r,t,n,i,o,f,p,g);{let m=x[s++];if((m&128)>0){s-=9;return}return D(r,t,n,i,o,f,p,g,m)}}else if(e<12){let m=x[s++],_=x[s++];if((m&128)>0||(_&128)>0){s-=10;return}if(e<11)return D(r,t,n,i,o,f,p,g,m,_);let b=x[s++];if((b&128)>0){s-=11;return}return D(r,t,n,i,o,f,p,g,m,_,b)}else{let m=x[s++],_=x[s++],b=x[s++],M=x[s++];if((m&128)>0||(_&128)>0||(b&128)>0||(M&128)>0){s-=12;return}if(e<14){if(e===12)return D(r,t,n,i,o,f,p,g,m,_,b,M);{let T=x[s++];if((T&128)>0){s-=13;return}return D(r,t,n,i,o,f,p,g,m,_,b,M,T)}}else{let T=x[s++],P=x[s++];if((T&128)>0||(P&128)>0){s-=14;return}if(e<15)return D(r,t,n,i,o,f,p,g,m,_,b,M,T,P);let G=x[s++];if((G&128)>0){s-=15;return}return D(r,t,n,i,o,f,p,g,m,_,b,M,T,P,G)}}}}}function Kr(){let e=x[s++],r;if(e<192)r=e-160;else switch(e){case 217:r=x[s++];break;case 218:r=k.getUint16(s),s+=2;break;case 219:r=k.getUint32(s),s+=4;break;default:throw new Error("Expected string")}return $e(r)}function rr(e){return V.copyBuffers?Uint8Array.prototype.slice.call(x,s,s+=e):x.subarray(s,s+=e)}function le(e){let r=x[s++];if(N[r])return N[r](x.subarray(s,s+=e));throw new Error("Unknown extension type "+r)}var Xr=new Array(4096);function Mt(){let e=x[s++];if(e>=160&&e<192){if(e=e-160,K>=s)return ne.slice(s-Z,(s+=e)-Z);if(!(K==0&&se<180))return sr(e)}else return s--,C();let r=(e<<5^(e>1?k.getUint16(s):e>0?x[s]:0))&4095,t=Xr[r],n=s,i=s+e-3,o,f=0;if(t&&t.bytes==e){for(;n<i;){if(o=k.getUint32(n),o!=t[f++]){n=1879048192;break}n+=4}for(i+=3;n<i;)if(o=x[n++],o!=t[f++]){n=1879048192;break}if(n===i)return s=n,t.string;i-=3,n=s}for(t=[],Xr[r]=t,t.bytes=e;n<i;)o=k.getUint32(n),t.push(o),n+=4;for(i+=3;n<i;)o=x[n++],t.push(o);let p=e<16?wr(e):At(e);return p!=null?t.string=p:t.string=sr(e)}const Qr=(e,r)=>{var t=C();let n=e;r!==void 0&&(e=e<32?-((r<<5)+e):(r<<5)+e,t.highByte=r);let i=A[e];return i&&i.isShared&&((A.restoreStructures||(A.restoreStructures=[]))[e]=i),A[e]=t,t.read=gr(t,n),t.read()};var Ut=typeof self=="object"?self:global;N[0]=()=>{};N[0].noBuffer=!0;N[101]=()=>{let e=C();return(Ut[e[0]]||Error)(e[1])};N[105]=e=>{let r=k.getUint32(s-4);Q||(Q=new Map);let t=x[s],n;t>=144&&t<160||t==220||t==221?n=[]:n={};let i={target:n};Q.set(r,i);let o=C();return i.used?Object.assign(n,o):(i.target=o,o)};N[112]=e=>{let r=k.getUint32(s-4),t=Q.get(r);return t.used=!0,t.target};N[115]=()=>new Set(C());const $t=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");N[116]=e=>{let r=e[0],t=$t[r];if(!t)throw new Error("Could not find typed array for code "+r);return new Ut[t](Uint8Array.prototype.slice.call(e,1).buffer)};N[120]=()=>{let e=C();return new RegExp(e[0],e[1])};const ei=[];N[98]=e=>{let r=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],t=s;return s+=r-e.length,L=ei,L=[Kr(),Kr()],L.position0=0,L.position1=0,L.postBundlePosition=s,s=t,C()};N[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function jt(e){let r=se,t=s,n=Z,i=K,o=ne,f=Q,p=L,g=new Uint8Array(x.slice(0,se)),m=A,_=A.slice(0,A.length),b=V,M=be,T=e();return se=r,s=t,Z=n,K=i,ne=o,Q=f,L=p,x=g,be=M,A=m,A.splice(0,A.length,..._),V=b,k=new DataView(x.buffer,x.byteOffset,x.byteLength),T}function ar(){x=null,Q=null,A=null}const yr=new Array(147);for(let e=0;e<256;e++)yr[e]=+("1e"+Math.floor(45.15-e*.30103));var Ve=new Te({useRecords:!1});const ri=Ve.unpack;Ve.unpackMultiple;Ve.unpack;let ti=new Float32Array(1);new Uint8Array(ti.buffer,0,4);let Ee;try{Ee=new TextEncoder}catch{}let or,Rt;const Ne=typeof Buffer!="undefined",We=Ne?Buffer.allocUnsafeSlow:Uint8Array,Wt=Ne?Buffer:Uint8Array,et=Ne?4294967296:2144337920;let u,Se,W,a=0,F,z=null;const ni=61440,ii=/[\u0080-\uFFFF]/,pe=Symbol("record-id");class si extends Te{constructor(r){super(r),this.offset=0;let t,n,i,o,f=0,p=Wt.prototype.utf8Write?function(l,v,d){return u.utf8Write(l,v,d)}:Ee&&Ee.encodeInto?function(l,v){return Ee.encodeInto(l,u.subarray(v)).written}:!1,g=this;r||(r={});let m=r&&r.sequential,_=r.structures||r.saveStructures,b=r.maxSharedStructures;if(b==null&&(b=_?32:0),b>8160)throw new Error("Maximum maxSharedStructure is 8160");r.structuredClone&&r.moreTypes==null&&(r.moreTypes=!0);let M=r.maxOwnStructures;M==null&&(M=_?32:64),!this.structures&&r.useRecords!=!1&&(this.structures=[]);let T=b>32||M+b>64,P=b+64,G=b+M+64;if(G>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let q=[],oe=0,Y=0;this.pack=this.encode=function(l,v){if(u||(u=new We(8192),W=new DataView(u.buffer,0,8192),a=0),F=u.length-10,F-a<2048?(u=new We(u.length),W=new DataView(u.buffer,0,u.length),F=u.length-10,a=0):a=a+7&2147483640,t=a,o=g.structuredClone?new Map:null,g.bundleStrings&&typeof l!="string"?(z=[],z.size=1/0):z=null,i=g.structures,i){i.uninitialized&&(i=g._mergeStructures(g.getStructures()));let d=i.sharedLength||0;if(d>b)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let c=0;c<d;c++){let h=i[c];if(!h)continue;let U,O=i.transitions;for(let y=0,I=h.length;y<I;y++){let $=h[y];U=O[$],U||(U=O[$]=Object.create(null)),O=U}O[pe]=c+64}f=d}m||(i.nextId=d+64)}n&&(n=!1);try{if(j(l),z&&nt(t,j),g.offset=a,o&&o.idsToInsert){a+=o.idsToInsert.length*6,a>F&&ue(a),g.offset=a;let d=oi(u.subarray(t,a),o.idsToInsert);return o=null,d}return v&ui?(u.start=t,u.end=a,u):u.subarray(t,a)}finally{if(i){Y<10&&Y++;let d=i.sharedLength||b;if(i.length>d&&(i.length=d),oe>1e4)i.transitions=null,Y=0,oe=0,q.length>0&&(q=[]);else if(q.length>0&&!m){for(let c=0,h=q.length;c<h;c++)q[c][pe]=0;q=[]}if(n&&g.saveStructures){let c=u.subarray(t,a);return g.saveStructures(i,f)===!1?(g._mergeStructures(g.getStructures()),g.pack(l)):(f=d,c)}}v&fi&&(a=t)}};const j=l=>{a>F&&(u=ue(a));var v=typeof l,d;if(v==="string"){let c=l.length;if(z&&c>=4&&c<4096){if((z.size+=c)>ni){let y,I=(z[0]?z[0].length*3+z[1].length:0)+10;a+I>F&&(u=ue(a+I)),z.position?(u[a]=200,a+=3,u[a++]=98,y=a-t,a+=4,nt(t,j),W.setUint16(y+t-3,a-t-y)):(u[a++]=214,u[a++]=98,y=a-t,a+=4),z=["",""],z.size=0,z.position=y}let O=ii.test(l);z[O?0:1]+=l,u[a++]=193,j(O?-c:c);return}let h;c<32?h=1:c<256?h=2:c<65536?h=3:h=5;let U=c*3;if(a+U>F&&(u=ue(a+U)),c<64||!p){let O,y,I,$=a+h;for(O=0;O<c;O++)y=l.charCodeAt(O),y<128?u[$++]=y:y<2048?(u[$++]=y>>6|192,u[$++]=y&63|128):(y&64512)===55296&&((I=l.charCodeAt(O+1))&64512)===56320?(y=65536+((y&1023)<<10)+(I&1023),O++,u[$++]=y>>18|240,u[$++]=y>>12&63|128,u[$++]=y>>6&63|128,u[$++]=y&63|128):(u[$++]=y>>12|224,u[$++]=y>>6&63|128,u[$++]=y&63|128);d=$-a-h}else d=p(l,a+h,U);d<32?u[a++]=160|d:d<256?(h<2&&u.copyWithin(a+2,a+1,a+1+d),u[a++]=217,u[a++]=d):d<65536?(h<3&&u.copyWithin(a+3,a+2,a+2+d),u[a++]=218,u[a++]=d>>8,u[a++]=d&255):(h<5&&u.copyWithin(a+5,a+3,a+3+d),u[a++]=219,W.setUint32(a,d),a+=4),a+=d}else if(v==="number")if(l>>>0===l)l<64?u[a++]=l:l<256?(u[a++]=204,u[a++]=l):l<65536?(u[a++]=205,u[a++]=l>>8,u[a++]=l&255):(u[a++]=206,W.setUint32(a,l),a+=4);else if(l>>0===l)l>=-32?u[a++]=256+l:l>=-128?(u[a++]=208,u[a++]=l+256):l>=-32768?(u[a++]=209,W.setInt16(a,l),a+=2):(u[a++]=210,W.setInt32(a,l),a+=4);else{let c;if((c=this.useFloat32)>0&&l<4294967296&&l>=-2147483648){u[a++]=202,W.setFloat32(a,l);let h;if(c<4||(h=l*yr[(u[a]&127)<<1|u[a+1]>>7])>>0===h){a+=4;return}else a--}u[a++]=203,W.setFloat64(a,l),a+=8}else if(v==="object")if(!l)u[a++]=192;else{if(o){let h=o.get(l);if(h){if(!h.id){let U=o.idsToInsert||(o.idsToInsert=[]);h.id=U.push(h)}u[a++]=214,u[a++]=112,W.setUint32(a,h.id),a+=4;return}else o.set(l,{offset:a-t})}let c=l.constructor;if(c===Object)Lr(l,!0);else if(c===Array){d=l.length,d<16?u[a++]=144|d:d<65536?(u[a++]=220,u[a++]=d>>8,u[a++]=d&255):(u[a++]=221,W.setUint32(a,d),a+=4);for(let h=0;h<d;h++)j(l[h])}else if(c===Map){d=l.size,d<16?u[a++]=128|d:d<65536?(u[a++]=222,u[a++]=d>>8,u[a++]=d&255):(u[a++]=223,W.setUint32(a,d),a+=4);for(let[h,U]of l)j(h),j(U)}else{for(let h=0,U=or.length;h<U;h++){let O=Rt[h];if(l instanceof O){let y=or[h];if(y.write){y.type&&(u[a++]=212,u[a++]=y.type,u[a++]=0),j(y.write.call(this,l));return}let I=u,$=W,X=a;u=null;let fe;try{fe=y.pack.call(this,l,me=>(u=I,I=null,a+=me,a>F&&ue(a),{target:u,targetView:W,position:a-me}),j)}finally{I&&(u=I,W=$,a=X,F=u.length-10)}fe&&(fe.length+a>F&&ue(fe.length+a),a=ai(fe,u,a,y.type));return}}Lr(l,!l.hasOwnProperty)}}else if(v==="boolean")u[a++]=l?195:194;else if(v==="bigint"){if(l<BigInt(1)<<BigInt(63)&&l>=-(BigInt(1)<<BigInt(63)))u[a++]=211,W.setBigInt64(a,l);else if(l<BigInt(1)<<BigInt(64)&&l>0)u[a++]=207,W.setBigUint64(a,l);else if(this.largeBigIntToFloat)u[a++]=203,W.setFloat64(a,Number(l));else throw new RangeError(l+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");a+=8}else if(v==="undefined")this.encodeUndefinedAsNil?u[a++]=192:(u[a++]=212,u[a++]=0,u[a++]=0);else if(v==="function")j(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+v)},Lr=this.useRecords===!1?this.variableMapSize?l=>{let v=Object.keys(l),d=v.length;d<16?u[a++]=128|d:d<65536?(u[a++]=222,u[a++]=d>>8,u[a++]=d&255):(u[a++]=223,W.setUint32(a,d),a+=4);let c;for(let h=0;h<d;h++)j(c=v[h]),j(l[c])}:(l,v)=>{u[a++]=222;let d=a-t;a+=2;let c=0;for(let h in l)(v||l.hasOwnProperty(h))&&(j(h),j(l[h]),c++);u[d+++t]=c>>8,u[d+t]=c&255}:r.progressiveRecords&&!T?(l,v)=>{let d,c=i.transitions||(i.transitions=Object.create(null)),h=a++-t,U;for(let O in l)if(v||l.hasOwnProperty(O)){if(d=c[O],d)c=d;else{let y=Object.keys(l),I=c;c=i.transitions;let $=0;for(let X=0,fe=y.length;X<fe;X++){let me=y[X];d=c[me],d||(d=c[me]=Object.create(null),$++),c=d}h+t+1==a?(a--,Qe(c,y,$)):Fr(c,y,h,$),U=!0,c=I[O]}j(l[O])}if(!U){let O=c[pe];O?u[h+t]=O:Fr(c,Object.keys(l),h,0)}}:(l,v)=>{let d,c=i.transitions||(i.transitions=Object.create(null)),h=0;for(let O in l)(v||l.hasOwnProperty(O))&&(d=c[O],d||(d=c[O]=Object.create(null),h++),c=d);let U=c[pe];U?U>=96&&T?(u[a++]=((U-=96)&31)+96,u[a++]=U>>5):u[a++]=U:Qe(c,c.__keys__||Object.keys(l),h);for(let O in l)(v||l.hasOwnProperty(O))&&j(l[O])},ue=l=>{let v;if(l>16777216){if(l-t>et)throw new Error("Packed buffer would be larger than maximum buffer size");v=Math.min(et,Math.round(Math.max((l-t)*(l>67108864?1.25:2),4194304)/4096)*4096)}else v=(Math.max(l-t<<2,u.length-1)>>12)+1<<12;let d=new We(v);return W=new DataView(d.buffer,0,v),u.copy?u.copy(d,0,t,l):d.set(u.slice(t,l)),a-=t,t=0,F=d.length-10,u=d},Qe=(l,v,d)=>{let c=i.nextId;c||(c=64),c<P&&this.shouldShareStructure&&!this.shouldShareStructure(v)?(c=i.nextOwnId,c<G||(c=P),i.nextOwnId=c+1):(c>=G&&(c=P),i.nextId=c+1);let h=v.highByte=c>=96&&T?c-96>>5:-1;l[pe]=c,l.__keys__=v,i[c-64]=v,c<P?(v.isShared=!0,i.sharedLength=c-63,n=!0,h>=0?(u[a++]=(c&31)+96,u[a++]=h):u[a++]=c):(h>=0?(u[a++]=213,u[a++]=114,u[a++]=(c&31)+96,u[a++]=h):(u[a++]=212,u[a++]=114,u[a++]=c),d&&(oe+=Y*d),q.length>=M&&(q.shift()[pe]=0),q.push(l),j(v))},Fr=(l,v,d,c)=>{let h=u,U=a,O=F,y=t;u=Se,a=0,t=0,u||(Se=u=new We(8192)),F=u.length-10,Qe(l,v,c),Se=u;let I=a;if(u=h,a=U,F=O,t=y,I>1){let $=a+I-1;$>F&&ue($);let X=d+t;u.copyWithin(X+I,X+1,a),u.set(Se.slice(0,I),X),a=$}else u[d+t]=Se[0]}}useBuffer(r){u=r,W=new DataView(u.buffer,u.byteOffset,u.byteLength),a=0}clearSharedData(){this.structures&&(this.structures=[])}}Rt=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,_t];or=[{pack(e,r,t){let n=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:i,targetView:o,position:f}=r(6);i[f++]=214,i[f++]=255,o.setUint32(f,n)}else if(n>0&&n<4294967296){let{target:i,targetView:o,position:f}=r(10);i[f++]=215,i[f++]=255,o.setUint32(f,e.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),o.setUint32(f+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return r(0),t(this.onInvalidDate());let{target:i,targetView:o,position:f}=r(3);i[f++]=212,i[f++]=255,i[f++]=255}else{let{target:i,targetView:o,position:f}=r(15);i[f++]=199,i[f++]=12,i[f++]=255,o.setUint32(f,e.getMilliseconds()*1e6),o.setBigInt64(f+4,BigInt(Math.floor(n)))}}},{pack(e,r,t){let n=Array.from(e),{target:i,position:o}=r(this.moreTypes?3:0);this.moreTypes&&(i[o++]=212,i[o++]=115,i[o++]=0),t(n)}},{pack(e,r,t){let{target:n,position:i}=r(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),t([e.name,e.message])}},{pack(e,r,t){let{target:n,position:i}=r(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),t([e.source,e.flags])}},{pack(e,r){this.moreTypes?rt(e,16,r):tt(Ne?Buffer.from(e):new Uint8Array(e),r)}},{pack(e,r){let t=e.constructor;t!==Wt&&this.moreTypes?rt(e,$t.indexOf(t.name),r):tt(e,r)}},{pack(e,r){let{target:t,position:n}=r(1);t[n]=193}}];function rt(e,r,t,n){let i=e.byteLength;if(i+1<256){var{target:o,position:f}=t(4+i);o[f++]=199,o[f++]=i+1}else if(i+1<65536){var{target:o,position:f}=t(5+i);o[f++]=200,o[f++]=i+1>>8,o[f++]=i+1&255}else{var{target:o,position:f,targetView:p}=t(7+i);o[f++]=201,p.setUint32(f,i+1),f+=4}o[f++]=116,o[f++]=r,o.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),f)}function tt(e,r){let t=e.byteLength;var n,i;if(t<256){var{target:n,position:i}=r(t+2);n[i++]=196,n[i++]=t}else if(t<65536){var{target:n,position:i}=r(t+3);n[i++]=197,n[i++]=t>>8,n[i++]=t&255}else{var{target:n,position:i,targetView:o}=r(t+5);n[i++]=198,o.setUint32(i,t),i+=4}n.set(e,i)}function ai(e,r,t,n){let i=e.length;switch(i){case 1:r[t++]=212;break;case 2:r[t++]=213;break;case 4:r[t++]=214;break;case 8:r[t++]=215;break;case 16:r[t++]=216;break;default:i<256?(r[t++]=199,r[t++]=i):i<65536?(r[t++]=200,r[t++]=i>>8,r[t++]=i&255):(r[t++]=201,r[t++]=i>>24,r[t++]=i>>16&255,r[t++]=i>>8&255,r[t++]=i&255)}return r[t++]=n,r.set(e,t),t+=i,t}function oi(e,r){let t,n=r.length*6,i=e.length-n;for(r.sort((o,f)=>o.offset>f.offset?1:-1);t=r.pop();){let o=t.offset,f=t.id;e.copyWithin(o+n,o,i),n-=6;let p=o+n;e[p++]=214,e[p++]=105,e[p++]=f>>24,e[p++]=f>>16&255,e[p++]=f>>8&255,e[p++]=f&255,i=o}return e}function nt(e,r){W.setUint32(z.position+e,a-z.position-e);let t=z;z=null,r(t[0]),r(t[1])}let Pt=new si({useRecords:!1});Pt.pack;Pt.pack;const ui=512,fi=1024;var li="https://izx.dalukuankuan.com/",Et="https://i-desk-ver.izhenxiang.com/",Ct,ci=async e=>{var r,t;return e=await e,t=[],r=t.push.bind(t),e.on("data",r),new Promise((n,i)=>(e.on("end",()=>{n(Buffer.concat(t))}),e.on("error",i)))},di=e=>ci(It(e));Ct=e=>{var r;return r=S.net.request(e),r.end(),new Promise((t,n)=>(r.on("error",i=>{n(i)}),r.on("response",i=>{if(i.statusCode!==200){n(i);return}t(i)})))};var It=e=>Ct(e),je={};je.version="1.0.0";je.encode=function(r){return r.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};je.decode=function(r){return r+=Array(5-r.length%4).join("="),r=r.replace(/\-/g,"+").replace(/\_/g,"/"),new Buffer(r,"base64")};je.validate=function(r){return/^[A-Za-z0-9\-_]+$/.test(r)};var tr=je;var we,Bt,Ce,qe,br,ke,vr,Dt,zt,mr,De,Lt,Sr,_r,ze,ur,Ze;zt=Vn.promisify(wt.brotliDecompress);var xi=()=>(S.app.relaunch(),S.app.exit());we=H.join(yt.ROOT,"v");re.mkdirSync(we,{recursive:!0});Bt="sha512";ze=void 0;var Ft=()=>{xe(ze),ze=void 0},Vt=()=>{Ft(),ze=ve.update({width:400,height:500,resizable:!1})};De=e=>di(Et+e);Lt=e=>{var r;return r=Fn.createHash(Bt),new Promise(t=>re.createReadStream(e).on("data",r.update.bind(r)).on("end",()=>{t(r.digest().slice(0,8))}))};ur=(()=>{var e;return{v:e}=Be.default,e&&ae.decode(e)})();var Nt=()=>ae.PACKAGE_JSON().version;vr=Hn+"/"+Gn+"/";Ze=ae.ver_int(Nt());ke=0;_r=async()=>{var e,r;e=ae.encode(parseInt(new Date/1e3)),r=vr+"v?"+e;try{ke=await De(r)}catch{console.error("❌",r)}return ke};Dt=async e=>{var r,t,n,i,o,f,p,g,m,_,b,M,T,P,G,q,oe,Y;if(e||(e=ke||await _r()),!!e&&(Y=e.readUintBE(0,6),!(Ze>=Y))){if(n=ae.encode(Y),r=H.join(we,n),re.existsSync(H.join(r,ae.package_json))&&Y===ur)return r;for(q=tr.encode(await De(vr+tr.encode(e))),[t,i,p]=ri(await zt(await De(q))),M=j=>Oe.mkdir(H.join(r,j),{recursive:!0}),await Promise.all(t.map(M)),P=H.dirname(__dirname),T=m=0,_=i.length;m<_;T=++m)if(g=i[T],o=H.join(r,g),f=p[T],G=async j=>Buffer.compare(f,await Lt(j))===0,!(re.existsSync(o)&&await G(o))){if(await M(H.dirname(g)),b=H.join(P,g),re.existsSync(b)&&await G(b)){await Oe.copyFile(b,o);continue}if(oe=re.createWriteStream(o),(await It(Et+tr.encode(f))).pipe(wt.createBrotliDecompress()).pipe(oe),await new Promise(j=>{oe.on("finish",j)}),!await G(o))return}return Be.default.v=n,ur=Y,r}};var qt=async()=>{var e,r;return e=await _r(),e&&(r=Ze<e.readUintBE(0,6),r)?e:0};mr=async()=>{var e;(e=await qt())&&await Zt(e)};setInterval(mr,864e5);Ce=qe=br=void 0;Sr=()=>qe=new Promise(e=>br=e);Sr();var hi=()=>qe,Zt=(...e)=>(Ce||(Ce=Dt(...e).then(async r=>{r&&(br([ke,JSON.parse(await Oe.readFile(H.join(r,ae.package_json),"utf8")).description]),Sr())}).finally(()=>{Ce=!1})),qe);setTimeout(async()=>{var e,r,t,n;if(re.existsSync(we)){n=await Oe.readdir(we,{withFileTypes:!0});for(r of n)r.isDirectory()&&({name:t}=r,ae.decode(t)<Ze&&await Oe.rm(H.join(we,t),{recursive:!0,force:!0}))}if(e=parseInt(new Date/864e5),e!==Be.default.update_check)return Be.default.update_check=e,await mr()},15e3);var pi=Object.freeze(Object.defineProperty({__proto__:null,relaunch:xi,x:Ft,show:Vt,ver_now:Nt,update_check:qt,update_promise:hi,update:Zt},Symbol.toStringTag,{value:"Module"}));var He,Or,Ht,Jt,Tr,gi,kr,Gt,Yt,Ae;Fe.default.platform();({Menu:Or,Tray:Ht,app:Jt,globalShortcut:gi}=require("electron"));Ae=new Ht(H.join(pr,"trayTemplate.png"));kr=[{label:"媒体库",click:()=>{S.shell.openExternal(li+"video_library.html?user_token="+St.ID)}},{label:"检测更新",click:Vt},{type:"separator"}];He=Gt=Or.buildFromTemplate([{label:"显示界面",click:ye},...kr,{label:"退出",click:()=>Jt.quit()}]);Yt=Or.buildFromTemplate(kr);Tr=["click",()=>{ye()}];Ae.on("right-click",e=>{Ae.popUpContextMenu(He)});var wi=()=>{Ae.off(...Tr),He=Yt},Kt=()=>{Ae.on(...Tr),He=Gt};var Xt;Xt=e=>{var r,t,n,i,o,f,p,g;e&&(e.devToolsWebContents||({webContents:o}=e,r=new S.BrowserWindow({minimizable:!1,maximizable:!1}),[i,t]=e.getSize(),[p,g]=e.getPosition(),{width:f,height:n}=S.screen.getPrimaryDisplay().workArea,o.setDevToolsWebContents(r.webContents),o.openDevTools({mode:"detach"}),i>t?(g=0,i=0,t+=20,n-=t):(p=0,t=0,f-=i),r.setPosition(i,t),e.setPosition(p,g),r.setSize(f,n),e.focus()))};var yi=()=>{S.globalShortcut.register("CmdOrCtrl+Alt+I",()=>Xt(S.BrowserWindow.getFocusedWindow()))},Je=e=>{S.BrowserWindow.getAllWindows().forEach(r=>{var t,n;if(n=r.webContents.getURL(),n){if({hash:t}=new URL(n),t=t.slice(1),t.startsWith("main")){e?(r[e](),e==="show"&&r.once("show",()=>{r.setAlwaysOnTop(!0,"screen-saver"),setTimeout(()=>r.setAlwaysOnTop(!1,"screen-saver"),1e3)})):r.hide();return}if(t.startsWith("camera"))return}xe(r)})},bi=()=>{S.BrowserWindow.getAllWindows().forEach(e=>{var r,t;if(t=e.webContents.getURL(),t&&({hash:r}=new URL(t),r=r.slice(1),r.startsWith("main"))){e.hide();return}xe(e)})},Qt,Ge,en,ce,R,Ar;({camera:en}=ve);R=void 0;ce=void 0;Qt=204;var rn=()=>{R&&!R.isDestroyed()&&R.getSize()[0]!==800&&(ce=R.getPosition()),xe(R)},vi=e=>{var r,t;t=R.getSize()[0],t!==e&&(ce=R.getPosition(),r=Math.round((e-t)/2),R.setBounds({x:ce[0]-r,y:ce[1]-r,width:e,height:e}))};Ge=!1;var tn=()=>Ar(800,500),mi=Ar=(e,r)=>{R&&!R.isDestroyed()||(R=en({width:e,height:r,center:!0,roundedCorners:!1,resizable:!1,transparent:!0}),Ge&&Mr())},Si=e=>{var r,t,n,i,o;R&&!R.isDestroyed()||(e=e||Qt,Ar(e,e),ce?[r,t]=ce:({width:o,height:n}=S.screen.getPrimaryDisplay().size,i=62,r=i,t=n-i-e),R.setPosition(r,t))},_i=()=>{rn(),tn()},Mr=()=>{R&&!R.isDestroyed()&&(R.setAlwaysOnTop(!0,"pop-up-menu"),R.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0})),Ge=!0},nn=()=>{R&&!R.isDestroyed()&&(R.setAlwaysOnTop(!1),R.setVisibleOnAllWorkspaces(!1)),Ge=!1},Oi=Object.freeze(Object.defineProperty({__proto__:null,x:rn,size:vi,rect:tn,default:mi,circle:Si,x_rect:_i,top:Mr,untop:nn},Symbol.toStringTag,{value:"Module"})),Ur=new Proxy({},{get:(e,r)=>()=>{var t,n,i;return{width:n,height:t}=S.screen.getPrimaryDisplay().size,i=ve[r]({width:n,height:t,roundedCorners:!1,transparent:!0,resizable:!1,hasShadow:!1}),i.setAlwaysOnTop(!0,"screen-saver"),i.setPosition(0,0),i.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),i}}),he={},$r={},Ti=require("./-.node");const it=Fe.default;let fr;(it.platform()==="win32"||it.platform()==="darwin")&&(fr=Ti.getIcon);const ki=(e,r=64)=>{if(!!fr)return fr(e,r)};var Ai=ki,Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});const ee=he,Mi=Fe.default,nr=e=>{if(!(!ee.addon||!ee.addon.getMonitorInfo))return ee.addon.getMonitorInfo(e)};class Ui{constructor(r){this.id=r}getBounds(){return nr(this.id).bounds}getWorkArea(){return nr(this.id).workArea}isPrimary(){return nr(this.id).isPrimary}getScaleFactor(){if(!ee.addon||!ee.addon.getMonitorScaleFactor)return;const r=Mi.release().split(".").map(t=>parseInt(t,10));return r[0]>8||r[0]===8&&r[1]>=1?ee.addon.getMonitorScaleFactor(this.id):1}isValid(){return ee.addon&&ee.addon.getMonitorInfo}}Ye.Monitor=Ui;var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});class $i{getBounds(){return{x:0,y:0,width:0,height:0}}getWorkArea(){return{x:0,y:0,width:0,height:0}}isPrimary(){return!1}getScaleFactor(){return 1}isValid(){return!1}}Ke.EmptyMonitor=$i;var ji=te&&te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($r,"__esModule",{value:!0});const w=he,Ri=ji(Ai),Wi=Ye,Pi=Ke;class Le{constructor(r){if(!w.addon)return;this.id=r;const{processId:t,path:n}=w.addon.initWindow(r);this.processId=t,this.path=n}getBounds(){if(!w.addon)return;const r=w.addon.getWindowBounds(this.id);if(process.platform==="win32"){const t=this.getMonitor().getScaleFactor();r.x=Math.floor(r.x/t),r.y=Math.floor(r.y/t),r.width=Math.floor(r.width/t),r.height=Math.floor(r.height/t)}return r}setBounds(r){if(!w.addon)return;const t=Object.assign(Object.assign({},this.getBounds()),r);if(process.platform==="win32"){const n=this.getMonitor().getScaleFactor();t.x=Math.floor(t.x*n),t.y=Math.floor(t.y*n),t.width=Math.floor(t.width*n),t.height=Math.floor(t.height*n),w.addon.setWindowBounds(this.id,t)}else process.platform==="darwin"&&w.addon.setWindowBounds(this.id,t)}getTitle(){if(!!w.addon)return w.addon.getWindowTitle(this.id)}getMonitor(){return!w.addon||!w.addon.getMonitorFromWindow?new Pi.EmptyMonitor:new Wi.Monitor(w.addon.getMonitorFromWindow(this.id))}show(){!w.addon||!w.addon.showWindow||w.addon.showWindow(this.id,"show")}hide(){!w.addon||!w.addon.showWindow||w.addon.showWindow(this.id,"hide")}minimize(){!w.addon||(process.platform==="win32"?w.addon.showWindow(this.id,"minimize"):process.platform==="darwin"&&w.addon.setWindowMinimized(this.id,!0))}restore(){!w.addon||(process.platform==="win32"?w.addon.showWindow(this.id,"restore"):process.platform==="darwin"&&w.addon.setWindowMinimized(this.id,!1))}maximize(){!w.addon||(process.platform==="win32"?w.addon.showWindow(this.id,"maximize"):process.platform==="darwin"&&w.addon.setWindowMaximized(this.id))}bringToTop(){!w.addon||(process.platform==="darwin"?w.addon.bringWindowToTop(this.id,this.processId):w.addon.bringWindowToTop(this.id))}redraw(){!w.addon||!w.addon.redrawWindow||w.addon.redrawWindow(this.id)}isWindow(){if(!!w.addon){if(process.platform==="win32")return this.path&&this.path!==""&&w.addon.isWindow(this.id);if(process.platform==="darwin")return this.path&&this.path!==""&&!!w.addon.initWindow(this.id)}}isVisible(){return!w.addon||!w.addon.isWindowVisible?!0:w.addon.isWindowVisible(this.id)}toggleTransparency(r){!w.addon||!w.addon.toggleWindowTransparency||w.addon.toggleWindowTransparency(this.id,r)}setOpacity(r){!w.addon||!w.addon.setWindowOpacity||w.addon.setWindowOpacity(this.id,r)}getOpacity(){return!w.addon||!w.addon.getWindowOpacity?1:w.addon.getWindowOpacity(this.id)}getIcon(r=64){return Ri.default(this.path,r)}setOwner(r){if(!w.addon||!w.addon.setWindowOwner)return;let t=r;r instanceof Le?t=r.id:r||(t=0),w.addon.setWindowOwner(this.id,t)}getOwner(){if(!(!w.addon||!w.addon.getWindowOwner))return new Le(w.addon.getWindowOwner(this.id))}}$r.Window=Le;var Ei=require("./..node"),Ci=te&&te.__awaiter||function(e,r,t,n){function i(o){return o instanceof t?o:new t(function(f){f(o)})}return new(t||(t=Promise))(function(o,f){function p(_){try{m(n.next(_))}catch(b){f(b)}}function g(_){try{m(n.throw(_))}catch(b){f(b)}}function m(_){_.done?o(_.value):i(_.value).then(p,g)}m((n=n.apply(e,r||[])).next())})};Object.defineProperty(he,"__esModule",{value:!0});const Ie=$r;he.Window=Ie.Window;const Ii=qn.default,st=Fe.default,Bi=Ye,Di=Ke;let B;he.addon=B;(st.platform()==="win32"||st.platform()==="darwin")&&(he.addon=B=Ei);let at=null,Pe=[];class zi extends Ii.EventEmitter{constructor(){super(),this.requestAccessibility=()=>!B||!B.requestAccessibility?!0:B.requestAccessibility(),this.getActiveWindow=()=>{if(!!B)return new Ie.Window(B.getActiveWindow())},this.getWindows=()=>!B||!B.getWindows?[]:B.getWindows().map(t=>new Ie.Window(t)).filter(t=>t.isWindow()),this.getMonitors=()=>!B||!B.getMonitors?[]:B.getMonitors().map(t=>new Bi.Monitor(t)),this.getPrimaryMonitor=()=>process.platform==="win32"?this.getMonitors().find(t=>t.isPrimary):new Di.EmptyMonitor,this.createProcess=(t,n="")=>{if(!(!B||!B.createProcess))return B.createProcess(t,n)};let r;!B||(this.on("newListener",t=>{if(t==="window-activated"&&(r=B.getActiveWindow()),Pe.indexOf(t)===-1){if(t==="window-activated")at=setInterval(()=>Ci(this,void 0,void 0,function*(){const n=B.getActiveWindow();r!==n&&(r=n,this.emit("window-activated",new Ie.Window(n)))}),50);else return;Pe.push(t)}}),this.on("removeListener",t=>{this.listenerCount(t)>0||(t==="window-activated"&&clearInterval(at),Pe=Pe.filter(n=>n!==t))}))}}const Li=new zi;var sn=he.windowManager=Li,jr,ie,lr,Rr,an,on,un,fn,E;({recbar:fn}=ve);E=void 0;ie=void 0;({draw:un}=Ur);var Fi=()=>{ie||(ie=un(),ie.on("close",()=>ie=void 0),ln())},ln=()=>{Me(),ie.focus()},Vi=()=>{xe(ie),ie=void 0};lr=["CommandOrControl+R","CommandOrControl+W","CommandOrControl+Q","Alt+F4","F5"];jr={"browser-window-focus":()=>{var e;for(e of lr)S.globalShortcut.register(e,()=>{})},"browser-window-blur":()=>{var e;for(e of lr)S.globalShortcut.unregister(e,()=>{})}};var Wr=e=>{var r;return e==="camera"?r=500:r=600,an(r)};an=e=>{var r,t,n,i,o,f,p,g;o=Object.entries(jr);for(g of o)[n,r]=g,S.app.on(n,r);return wi(),t=48,i={roundedCorners:!1,transparent:!0,resizable:!1,width:e,height:t},E=fn(i),E.on("close",()=>E=void 0),{width:p,height:f}=S.screen.getPrimaryDisplay().workArea,E.setBounds({x:Math.round((p-e)/2),y:f-28-t,width:e,height:t}),Me(),Mr(),new Promise(m=>E.webContents.on("did-finish-load",()=>{Me(),E.focus(),m(E)}))};var Me=()=>{E&&(E.setAlwaysOnTop(!0,"screen-saver"),E.moveTop())},Ni=()=>{var e,r,t,n,i;n=E.getPosition(),[t,r]=E.getSize(),[i,e]=E.size,E.setBounds({x:n[0]+t-i,y:n[1],width:i,height:e})},qi=()=>{var e,r,t,n;r=E.getPosition(),E.size=t=E.getSize(),n=162,e=48,E.setBounds({x:r[0]+t[0]-n,y:r[1],width:n,height:e})};Rr=()=>{var e,r,t,n;t=Object.entries(jr);for(n of t)[r,e]=n,S.app.off(r,e);Kt(),nn()};var Zi=()=>{Rr(),Je("show")},Hi=()=>{Rr(),Je()},Ji=()=>{E.hide()};on=(...e)=>S.desktopCapturer.getSources({types:e,thumbnailSize:{width:0,height:0}});var Gi=async()=>{var e,r;r=await on("screen");for(e of r)return e.id},Yi=async()=>{var e,r,t,n,i,o,f,p,g,m,_,b,M,T,P;({bounds:e}=S.screen.getPrimaryDisplay()),{scaleFactor:_}=S.screen.getPrimaryDisplay(),o=new Map,g=await S.desktopCapturer.getSources({types:["window"],fetchWindowIcons:!1,thumbnailSize:{width:320*_,height:180*_}});for(n of g)o.set(Math.floor(n.id.split(":")[1]),[n.thumbnail.toDataURL(),n.name]);p=[],m=sn.getWindows();for(n of m)if({id:i}=n,!process.execPath.startsWith(n.path)&&(f=o.get(i),f)){if({x:T,y:P,width:M,height:t}=n.getBounds(),T+M<=0&&T<=0||T+M>e.width&&T>e.width||P+t<=0&&P<=0||P+t>e.height&&P>e.height)continue;b=e.width-T,M>b&&(M=b),r=e.height-P,t>r&&(t=r),T<0&&(T=0),P<0&&(P=0),p.push(f.concat([i,T,P,M,t]))}return p},Ki=e=>{S.BrowserWindow.getAllWindows().forEach(r=>{var t;if({hash:t}=new URL(r.webContents.getURL()),!e&&t.slice(1)==="camera"){xe(r);return}return r.hide()})},Xi=Object.freeze(Object.defineProperty({__proto__:null,draw:Fi,draw_top:ln,draw_x:Vi,工具条:Wr,top:Me,expand:Ni,left:qi,cancel:Zi,end:Hi,hide:Ji,screen_source:Gi,win_source:Yi,stop:Ki},Symbol.toStringTag,{value:"Module"})),cn,J;({count_down:cn}=ve);J=void 0;var dn=()=>{var e;if(J){J.focus();return}e=240,J=cn({width:e,height:e,transparent:!0,resizable:!1,hasShadow:!1}),J.on("close",()=>{J=void 0}),J.setAlwaysOnTop(!0,"screen-saver"),J.on("show",()=>{var r,t;t=S.BrowserWindow.getAllWindows();for(r of t)r.webContents.getURL().endsWith("/#main")||r.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0})})},Qi={hide:()=>{J!=null&&J.hide()},close:()=>{J!=null&&J.close(),Me()}},es=typeof te=="object"&&te&&te.Object===Object&&te,rs=es,ts=rs,ns=typeof self=="object"&&self&&self.Object===Object&&self,is=ts||ns||Function("return this")(),ss=is,as=ss,os=as.Symbol,Pr=os;function us(e,r){for(var t=-1,n=e==null?0:e.length,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}var fs=us,ls=Array.isArray,cs=ls,ot=Pr,xn=Object.prototype,ds=xn.hasOwnProperty,xs=xn.toString,_e=ot?ot.toStringTag:void 0;function hs(e){var r=ds.call(e,_e),t=e[_e];try{e[_e]=void 0;var n=!0}catch{}var i=xs.call(e);return n&&(r?e[_e]=t:delete e[_e]),i}var ps=hs,gs=Object.prototype,ws=gs.toString;function ys(e){return ws.call(e)}var bs=ys,ut=Pr,vs=ps,ms=bs,Ss="[object Null]",_s="[object Undefined]",ft=ut?ut.toStringTag:void 0;function Os(e){return e==null?e===void 0?_s:Ss:ft&&ft in Object(e)?vs(e):ms(e)}var Ts=Os;function ks(e){return e!=null&&typeof e=="object"}var As=ks,Ms=Ts,Us=As,$s="[object Symbol]";function js(e){return typeof e=="symbol"||Us(e)&&Ms(e)==$s}var Rs=js,lt=Pr,Ws=fs,Ps=cs,Es=Rs,Cs=1/0,ct=lt?lt.prototype:void 0,dt=ct?ct.toString:void 0;function hn(e){if(typeof e=="string")return e;if(Ps(e))return Ws(e,hn)+"";if(Es(e))return dt?dt.call(e):"";var r=e+"";return r=="0"&&1/e==-Cs?"-0":r}var Is=hn,Bs=Is;function Ds(e){return e==null?"":Bs(e)}var Xe=Ds;function zs(e,r,t){var n=-1,i=e.length;r<0&&(r=-r>i?0:i+r),t=t>i?i:t,t<0&&(t+=i),i=r>t?0:t-r>>>0,r>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+r];return o}var Ls=zs,Fs=Ls;function Vs(e,r,t){var n=e.length;return t=t===void 0?n:t,!r&&t>=n?e:Fs(e,r,t)}var Ns=Vs,qs="\\ud800-\\udfff",Zs="\\u0300-\\u036f",Hs="\\ufe20-\\ufe2f",Js="\\u20d0-\\u20ff",Gs=Zs+Hs+Js,Ys="\\ufe0e\\ufe0f",Ks="\\u200d",Xs=RegExp("["+Ks+qs+Gs+Ys+"]");function Qs(e){return Xs.test(e)}var pn=Qs;function ea(e){return e.split("")}var ra=ea,gn="\\ud800-\\udfff",ta="\\u0300-\\u036f",na="\\ufe20-\\ufe2f",ia="\\u20d0-\\u20ff",sa=ta+na+ia,aa="\\ufe0e\\ufe0f",oa="["+gn+"]",cr="["+sa+"]",dr="\\ud83c[\\udffb-\\udfff]",ua="(?:"+cr+"|"+dr+")",wn="[^"+gn+"]",yn="(?:\\ud83c[\\udde6-\\uddff]){2}",bn="[\\ud800-\\udbff][\\udc00-\\udfff]",fa="\\u200d",vn=ua+"?",mn="["+aa+"]?",la="(?:"+fa+"(?:"+[wn,yn,bn].join("|")+")"+mn+vn+")*",ca=mn+vn+la,da="(?:"+[wn+cr+"?",cr,yn,bn,oa].join("|")+")",xa=RegExp(dr+"(?="+dr+")|"+da+ca,"g");function ha(e){return e.match(xa)||[]}var pa=ha,ga=ra,wa=pn,ya=pa;function ba(e){return wa(e)?ya(e):ga(e)}var va=ba,ma=Ns,Sa=pn,_a=va,Oa=Xe;function Ta(e){return function(r){r=Oa(r);var t=Sa(r)?_a(r):void 0,n=t?t[0]:r.charAt(0),i=t?ma(t,1).join(""):r.slice(1);return n[e]()+i}}var ka=Ta,Aa=ka,Ma=Aa("toUpperCase"),Sn=Ma,Ua=Xe,$a=Sn;function ja(e){return $a(Ua(e).toLowerCase())}var Ra=ja;function Wa(e,r,t,n){var i=-1,o=e==null?0:e.length;for(n&&o&&(t=e[++i]);++i<o;)t=r(t,e[i],i,e);return t}var Pa=Wa;function Ea(e){return function(r){return e==null?void 0:e[r]}}var Ca=Ea,Ia=Ca,Ba={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Da=Ia(Ba),za=Da,La=za,Fa=Xe,Va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Na="\\u0300-\\u036f",qa="\\ufe20-\\ufe2f",Za="\\u20d0-\\u20ff",Ha=Na+qa+Za,Ja="["+Ha+"]",Ga=RegExp(Ja,"g");function Ya(e){return e=Fa(e),e&&e.replace(Va,La).replace(Ga,"")}var Ka=Ya,Xa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Qa(e){return e.match(Xa)||[]}var eo=Qa,ro=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function to(e){return ro.test(e)}var no=to,_n="\\ud800-\\udfff",io="\\u0300-\\u036f",so="\\ufe20-\\ufe2f",ao="\\u20d0-\\u20ff",oo=io+so+ao,On="\\u2700-\\u27bf",Tn="a-z\\xdf-\\xf6\\xf8-\\xff",uo="\\xac\\xb1\\xd7\\xf7",fo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",lo="\\u2000-\\u206f",co=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kn="A-Z\\xc0-\\xd6\\xd8-\\xde",xo="\\ufe0e\\ufe0f",An=uo+fo+lo+co,Mn="['’]",xt="["+An+"]",ho="["+oo+"]",Un="\\d+",po="["+On+"]",$n="["+Tn+"]",jn="[^"+_n+An+Un+On+Tn+kn+"]",go="\\ud83c[\\udffb-\\udfff]",wo="(?:"+ho+"|"+go+")",yo="[^"+_n+"]",Rn="(?:\\ud83c[\\udde6-\\uddff]){2}",Wn="[\\ud800-\\udbff][\\udc00-\\udfff]",ge="["+kn+"]",bo="\\u200d",ht="(?:"+$n+"|"+jn+")",vo="(?:"+ge+"|"+jn+")",pt="(?:"+Mn+"(?:d|ll|m|re|s|t|ve))?",gt="(?:"+Mn+"(?:D|LL|M|RE|S|T|VE))?",Pn=wo+"?",En="["+xo+"]?",mo="(?:"+bo+"(?:"+[yo,Rn,Wn].join("|")+")"+En+Pn+")*",So="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_o="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Oo=En+Pn+mo,To="(?:"+[po,Rn,Wn].join("|")+")"+Oo,ko=RegExp([ge+"?"+$n+"+"+pt+"(?="+[xt,ge,"$"].join("|")+")",vo+"+"+gt+"(?="+[xt,ge+ht,"$"].join("|")+")",ge+"?"+ht+"+"+pt,ge+"+"+gt,_o,So,Un,To].join("|"),"g");function Ao(e){return e.match(ko)||[]}var Mo=Ao,Uo=eo,$o=no,jo=Xe,Ro=Mo;function Wo(e,r,t){return e=jo(e),r=t?void 0:r,r===void 0?$o(e)?Ro(e):Uo(e):e.match(r)||[]}var Po=Wo,Eo=Pa,Co=Ka,Io=Po,Bo="['’]",Do=RegExp(Bo,"g");function zo(e){return function(r){return Eo(Io(Co(r).replace(Do,"")),e,"")}}var Lo=zo,Fo=Ra,Vo=Lo,No=Vo(function(e,r,t){return r=r.toLowerCase(),e+(t?Fo(r):r)}),qo=No;var Zo=async e=>{var r;if(r=await Promise.resolve().then(function(){return require("./f.js")}).then(function(t){return t.index}),r.getAuthStatus(e)!=="authorized")return e==="screen"?e="ScreenCapture":e=Sn(qo(e)),r[`askFor${e}Access`](),!0};var Ue,Er,Cr,Ir,Br;Ue=Cr=Er=void 0;Ir=()=>{Er=new Promise(e=>{Cr=e})};Ir();Br=e=>{Ue.once("closed",()=>{Cr(e),Ir()}),xe(Ue)};var Ho=()=>{Br(!0)},Jo=()=>{Br(!1)},Go=e=>(Ue=Ur["confirm_"+e]({width:275,height:190,modal:!0,isAlwaysOnTop:!0,visibleOnAllWorkspaces:!0}),Ue.setAlwaysOnTop(!0,"screen-saver"),Er),Yo=Object.freeze(Object.defineProperty({__proto__:null,y:Ho,n:Jo,show:Go},Symbol.toStringTag,{value:"Module"})),Ko=e=>{St.ID=e},Xo=Object.freeze(Object.defineProperty({__proto__:null,ID:Ko},Symbol.toStringTag,{value:"Module"})),Qo=function(){var e,r,t;return t=this.sender.getOwnerBrowserWindow(),r=t.getBounds(),e=n=>{var i,o;if(o=t[n],i=r[n],o&&i>o&&i-o<3){r[n]=o;return}t[n]=i},["height","width"].map(e),r},e0=function(e,r,t,n){var i;i=this.sender.getOwnerBrowserWindow(),i.setBounds({x:Math.round(e),y:Math.round(r),width:t,height:n})},r0=Object.freeze(Object.defineProperty({__proto__:null,getBounds:Qo,setBounds:e0},Symbol.toStringTag,{value:"Module"}));var Cn,Dr,zr,de,In;({area:Cn,win_area:In}=Ur);de=void 0;var t0=e=>{var r,t,n;t=void 0,n=sn.getWindows();for(r of n)if(e===r.id){t=r;break}t&&(de.setAlwaysOnTop(!1),t.bringToTop(),zr())};zr=()=>{de.setAlwaysOnTop(!0,"screen-saver")};Dr=e=>{de=e(),zr(),de.on("close",()=>de=void 0)};var n0=()=>Dr(In),i0=()=>Dr(Cn),s0=()=>{Wr(),de.setIgnoreMouseEvents(!0,{forward:!0}),dn()},a0=()=>{var e,r;return{x:e,y:r}=S.screen.getCursorScreenPoint(),[e,r]};function o0(e,r,t,n){var i;if(i=e==="camera",!i&&n){[n0,i0][n-1]();return}else dn();Wr(e)}var u0=(e,r,t,n)=>{Je(),o0(e,r,t,n)},f0=e=>{S.shell.openExternal(e)},l0=()=>yt.ROOT,c0=Object.freeze(Object.defineProperty({__proto__:null,userData:l0,close:Je,x:bi,count_down:Qi,permission:Zo,confirm:Yo,auto_update:pi,recbar:Xi,USER:Xo,camera:Oi,drag:r0,area:s0,wintop:t0,main:ye,mouse:a0,rec:u0,open:f0},Symbol.toStringTag,{value:"Module"}));process.on("exit",()=>{S.app.quit()});S.app.requestSingleInstanceLock()||(S.app.quit(),process.exit(0));(async()=>{var e;e=await Promise.resolve().then(function(){return require("./e.js")}),e.init({dsn:"https://54c0fbe278e049c8a9635fc0fa612836@sentry.dalukuankuan.com/6"})})();S.app.commandLine.appendSwitch("webrtc-max-cpu-consumption-percentage","100");S.app.commandLine.appendSwitch("js-flags","--expose_gc --max-old-space-size=512");(()=>{var e,r,t,n,i,o;ye(),(t=S.app.dock)!=null&&t.hide(),e=(f,p)=>{var g,m,_,b;p instanceof Function&&S.ipcMain.handle(f.join("."),(M,T)=>p.apply(M,T)),_=Object.entries(p);for(b of _)[m,g]=b,e([...f,m],g)},n=Object.entries(c0);for(o of n)[r,i]=o,e([r],i);Kt(),yi()})();Jn(S.app,{"second-instance":ye,activate:ye});var d0=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));exports.boot=d0;exports.getAugmentedNamespace=Zn;
